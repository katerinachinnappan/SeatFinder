top; configure terminal;

crypto
  certificate "cmc-webapi-sslsvr-apifsh-1" "config:///toolkit-gateway-cert.pem" ignore-expiration
  certificate "webapi-mgmt-client-pubcert" "config:///toolkit-gateway-cert.pem" ignore-expiration
  certificate "x2020_pubcert" "config:///toolkit-gateway-cert.pem" ignore-expiration
  key "cmc-webapi-sslsvr-apifsh-0" "config:///toolkit-gateway-key.pem"
  key "webapi-mgmt-client-privkey" "config:///toolkit-gateway-key.pem"
  key "x2020_privkey" "config:///toolkit-gateway-key.pem"
  sskey "webapi-oauth-token-ss" "config:///toolkit-oauth-aes256-ss.txt"
  idcred "cmc-webapi-sslsvr-apifsh" "cmc-webapi-sslsvr-apifsh-0" "cmc-webapi-sslsvr-apifsh-1"
  profile "cmc-webapi-sslsvr-apifsh" "cmc-webapi-sslsvr-apifsh" option-string OpenSSL-default+Disable-SSLv2+Disable-SSLv3 ciphers "HIGH:MEDIUM:!aNULL:!eNULL:!RC4:@STRENGTH" clientcalist off
exit

sslproxy "cmc-webapi-sslsvr-apifsh" "reverse" "cmc-webapi-sslsvr-apifsh" sess-timeout "300" cache-size "20"

crypto
  ssl-server "cmc-webapi-sslsvr-apifsh"
    protocols "TLSv1d0+TLSv1d1+TLSv1d2"
    ciphers ECDHE_RSA_WITH_AES_256_GCM_SHA384
    ciphers ECDHE_RSA_WITH_AES_256_CBC_SHA384
    ciphers ECDHE_RSA_WITH_AES_256_CBC_SHA
    ciphers DHE_DSS_WITH_AES_256_GCM_SHA384
    ciphers DHE_RSA_WITH_AES_256_GCM_SHA384
    ciphers DHE_RSA_WITH_AES_256_CBC_SHA256
    ciphers DHE_DSS_WITH_AES_256_CBC_SHA256
    ciphers DHE_RSA_WITH_AES_256_CBC_SHA
    ciphers DHE_DSS_WITH_AES_256_CBC_SHA
    ciphers RSA_WITH_AES_256_GCM_SHA384
    ciphers RSA_WITH_AES_256_CBC_SHA256
    ciphers RSA_WITH_AES_256_CBC_SHA
    ciphers ECDHE_RSA_WITH_AES_128_GCM_SHA256
    ciphers ECDHE_RSA_WITH_AES_128_CBC_SHA256
    ciphers ECDHE_RSA_WITH_AES_128_CBC_SHA
    ciphers DHE_DSS_WITH_AES_128_GCM_SHA256
    ciphers DHE_RSA_WITH_AES_128_GCM_SHA256
    ciphers DHE_RSA_WITH_AES_128_CBC_SHA256
    ciphers DHE_DSS_WITH_AES_128_CBC_SHA256
    ciphers DHE_RSA_WITH_AES_128_CBC_SHA
    ciphers DHE_DSS_WITH_AES_128_CBC_SHA
    ciphers RSA_WITH_AES_128_GCM_SHA256
    ciphers RSA_WITH_AES_128_CBC_SHA256
    ciphers RSA_WITH_AES_128_CBC_SHA
    ciphers ECDHE_RSA_WITH_3DES_EDE_CBC_SHA
    ciphers DHE_RSA_WITH_3DES_EDE_CBC_SHA
    ciphers DHE_DSS_WITH_3DES_EDE_CBC_SHA
    ciphers RSA_WITH_3DES_EDE_CBC_SHA
    idcred cmc-webapi-sslsvr-apifsh
    no request-client-auth
    require-client-auth
    no validate-client-cert
    send-client-auth-ca-list
    caching
    cache-timeout 300
    cache-size 20
    ssl-options ""
    max-duration 60
    max-renegotiation-allowed 0
    no prohibit-resume-on-reneg
    no compression
    no allow-legacy-renegotiation
    prefer-server-ciphers
    curves secp521r1
    curves secp384r1
    curves secp256k1
    curves secp256r1
  exit

  ssl-sni-mapping "cmc-webapi-sslsvr-apifsh"
    sni-mapping "*" "cmc-webapi-sslsvr-apifsh"
  exit

  ssl-sni-server "cmc-webapi-sslsvr-apifsh"
    protocols "TLSv1d0+TLSv1d1+TLSv1d2"
    sni-server-mapping cmc-webapi-sslsvr-apifsh
    sni-server-default cmc-webapi-sslsvr-apifsh
    ssl-options ""
    max-duration 3600
    max-renegotiation-allowed 0
  exit
exit

config-sequence "apiconnect"
  location "local:///"
  watch "on"
  match "(.*)\.cfg$"
  summary "Toolkit Reboot configuration"
exit
