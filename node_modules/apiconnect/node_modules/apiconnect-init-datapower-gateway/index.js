#!/usr/bin/env node

/********************************************************* {COPYRIGHT-TOP} ***
 * Licensed Materials - Property of IBM
 * 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
 *
 * (C) Copyright IBM Corporation 2017
 *
 * All Rights Reserved.
 * US Government Users Restricted Rights - Use, duplication or disclosure
 * restricted by GSA ADP Schedule Contract with IBM Corp.
 ********************************************************** {COPYRIGHT-END} **/

'use strict';

// Ignore mgmt-lite logger output
process.env.LOG_LEVEL = 'fatal';

const config   = require('./lib/argv-config');
const datapowerInit = require('./lib/datapower-init.js');
const logger = require('./lib/logger.js').logger;

/*
 * 1. Determine Operating System
 *  - Linux
 *  - OSX
 *  - Windows 7
 *  - Windows 10
 *
 * 2. Is docker installed? Which version?
 *
 * 3. Is docker-compose installed? Which version?
 *
 * 4. Download images
 *
 * 5. Test networking
 *
 */

function main () {
  let buildConfig = config.BuildConfigFromCMD(process.argv);
  
  let p = datapowerInit.initializeDatapower(buildConfig).catch(err => {
    process.exit(1);
  });
}

module.exports = function (config, log) {
  logger.setWriteLog(log);
  return datapowerInit.initializeDatapower(config);
};

if (require.main === module)
  main();
