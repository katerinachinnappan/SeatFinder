/********************************************************* {COPYRIGHT-TOP} ***
 * Licensed Materials - Property of IBM
 * 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
 *
 * (C) Copyright IBM Corporation 2017
 *
 * All Rights Reserved.
 * US Government Users Restricted Rights - Use, duplication or disclosure
 * restricted by GSA ADP Schedule Contract with IBM Corp.
 ********************************************************** {COPYRIGHT-END} **/

 'use strict';

const stripIndent = require('common-tags').stripIndent;

function copyargs () {
  let args = [];
  let alen = arguments.length;
  for (let i = 1; i < alen; i++)
    args.push(arguments[i]);
  return args;
}

module.exports = function (ErrorCatalog) {
  return function error (id) {
    if (!id)
      return new Error('Unknown error');
    let errfn = ErrorCatalog[id];
    if (!errfn)
      return new Error(`Unknown error: ${id}`);
    let args = copyargs.apply(null, arguments);
    let errstr = errfn.apply(null, args);
    // FIXME should be done with subclasses of Error
    let err = new Error(stripIndent`${errstr}`);
    err.validation = true;
    return err;
  };
};
