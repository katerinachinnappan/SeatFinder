// Copyright IBM Corp. 2016,2017. All Rights Reserved.
// Node module: apiconnect-collective-jmx
// US Government Users Restricted Rights - Use, duplication or disclosure
// restricted by GSA ADP Schedule Contract with IBM Corp.

'use strict';

var getSetDataInRegistry = require('./server-command.js').getSetDataInRegistry;
var mandatory = require('../util/mandatory');

exports.createSwaggerSpec = createSwaggerSpec;
exports.deleteSwaggerSpec = deleteSwaggerSpec;

function deleteSwaggerSpec(options) {
  var path = getSwaggerPath(options);
  var _options = {
    hostName: options.hostName,
    serverName: options.serverName,
    userDir: options.userDir,
    path: path,
  };
  return getSetDataInRegistry(_options, 'delete');
};

function createSwaggerSpec(options) {
  var path = getSwaggerPath(options);
  var _options = {
    hostName: options.hostName,
    serverName: options.serverName,
    userDir: options.userDir,
    path: path,
    data: options.swaggerSpec,
  };
  return getSetDataInRegistry(_options, 'create');
};

function getSwaggerPath(options) {
  mandatory(options.hostName, 'hostName is missing');
  mandatory(options.serverName, 'serverName is missing');
  mandatory(options.userDir, 'userDir is missing');
  mandatory(options.swaggerSpec, 'swaggerSpec is missing');

  var path = '/sys.was.collectives/local/' +
    'hosts/' + options.hostName +
    '/userdirs/' + encodeURIComponent(options.userDir) +
    '/servers/' + options.serverName +
    '/sys.rest.api.doc/' +
    (options.yamlSwaggerSpec ? 'Swagger_20_YAML' : 'Swagger_20_JSON');

  return path;
}
