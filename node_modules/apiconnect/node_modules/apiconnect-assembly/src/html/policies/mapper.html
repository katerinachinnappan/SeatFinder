<div data-ng-controller="MapperController as mapperController">
	<fieldset data-ng-disabled="selectedNode.$$readOnly || selectedNode.$$parentReadOnly">
		<div data-ng-if="mapperController.currentPage == 'map'">
			<div class="mapper-container">
				<div class="mapper-inputs">
					<div class="mapper-header">{{::'assemblyMapSource' | translate}}
						<button class="mapperEditIcon iconOnlyButton floatRight material-icons" data-ng-click="mapperController.currentPage = 'inputs';" title="{{::'assemblyEditInputs' | translate}}" aria-label="{{::'assemblyEditInputs' | translate}}">edit</button>
					</div>
					<div class="mapper-inputs-container">
						<div data-ng-repeat="inputSchema in $parent.inputSchemas" class="schema-block">
							<apic-mapper-schema class="mapper-input-schema" data-ng-attr-schema="inputSchema" data-editable="!map.readOnly" data-references="references" open="5" data-ng-attr-definitions="swaggerDocument"></apic-mapper-schema>
							<div class="clearBoth"></div>
						</div>
					</div>
				</div><div class="mapper-transformation">
					<div class="mapper-header">
						<button class="mapperEditIcon iconOnlyButton material-icons" style="float: left;" data-ng-click="mapperController.currentPage = 'options';" title="{{::'assemblerMapperConfigure' | translate}}" aria-label="{{::'assemblerMapperConfigure' | translate}}">settings</button>
						<span>{{::'assemblyMapTransformation' | translate}}</span>
						<button class="mapperEditIcon iconOnlyButton floatRight material-icons" data-ng-click="mapperController.constructCanvas();" title="{{::'assemblyRefresh' | translate}}" aria-label="{{::'assemblyRefresh' | translate}}">refresh</button>
					</div>
					<svg width="300" height="400" id="node-mapper" class="mapper-canvas">
					</svg>
				</div><div class="mapper-outputs">
					<div class="mapper-header">{{::'assemblyMapTarget' | translate}}
						<button class="mapperEditIcon iconOnlyButton floatRight material-icons" data-ng-click="mapperController.currentPage = 'outputs';" title="{{::'assemblyEditOutputs' | translate}}" aria-label="{{::'assemblyEditOutputs' | translate}}">edit</button>
					</div>
					<div class="mapper-outputs-container">
						<div data-ng-repeat="outputSchema in $parent.outputSchemas" class="schema-block">
							<apic-mapper-schema class="mapper-output-schema" data-ng-attr-schema="outputSchema" data-editable="!map.readOnly" data-references="references" open="5" data-ng-attr-definitions="swaggerDocument"></apic-mapper-schema>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div style="margin: 10px;" data-ng-if="mapperController.currentPage == 'inputs'">
			<div data-ng-controller="MapInputOutputController as inOutController" data-ng-repeat="(name, object) in selectedNode.inputs track by name">
				<div class="mapObject">
					<md-input-container class="halfWidth">
						<label>{{::'assemblyContextVariable' | translate}}</label>
						<input apim-context-variable data-ng-model="object.variable" data-ng-model-options="{debounce:200}"/>
					</md-input-container>
					<md-input-container class="halfWidth">
						<label>{{::"assemblyMapName" | translate}}</label>
						<input data-ng-model="$inputName" data-ng-model-options="{getterSetter: true, updateOn: 'blur'}"/>
					</md-input-container>
					<div style="width: 88px;"></div>
				</div>
				<div class="mapObject">
					<div class="halfWidth">
						<label style="padding-left: 3px;" for="$id + '_inputType'">{{::"assemblyContentType" | translate}}</label>
						<apim-combobox style="font-weight: bold;" id="$id + '_inputType'" item-list="inOutController.contentTypes" selection="contentType"></apim-combobox>
					</div>
					<md-input-container class="halfWidth">
						<label for="$id + '_definition'">{{::'assemblyDefinition' | translate}}</label>
						<md-select required data-ng-model="selectedDefinition">
							<md-option data-ng-repeat="definition in definitions" data-ng-value="definition.value || definition.name">{{definition.name}}</md-option>
						</md-select>
					</md-input-container>
					<button style="margin: 10px;" data-ng-show="selectedDefinition == 'inline'" class="iconOnlyButton material-icons" data-ng-click="inOutController.launchInlineEditor()" title="{{::'assembly_edit_inline_definition' | translate}}">code</button>
					<div style="width: 44px;"  data-ng-show="selectedDefinition !== 'inline'"></div>
					<button style="margin: 10px;" class="iconOnlyButton material-icons" data-ng-click="mapperController.removeInput(name)" title="{{::'assemblyRemoveInput' | translate}}">delete</button>
				</div>
			</div>
			<div>
				<button data-ng-click="mapperController.addInput()" title="{{::'assemblyAddInputTitle' | translate}}">{{::'assemblyAddInputTitle' | translate}}</button>
				<md-menu>
					<md-button ng-click="$mdOpenMenu($event);" title="{{::'assemblyAddParametersTitle' | translate}}">{{::'assemblyAddParametersTitle' | translate}}</md-button>
					<md-menu-content>
						<md-menu-item data-ng-repeat="operation in swaggerOperations">
							<span data-ng-if="operation.operationId" data-ng-click="mapperController.addParametersForOperation(operation);">{{operation.operationId}}</span>
							<span data-ng-if="!operation.operationId" data-ng-click="mapperController.addParametersForOperation(operation);">{{operation.verb}} {{operation.path}}</span>
						</md-menu-item>
					</md-menu-content>
				</md-menu>
				<button style="float: right;" data-ng-click="mapperController.switchToMap();" title="{{::'assemblyDone' | translate}}">{{::'assemblyDone' | translate}}</button>
			<div class="clearBoth"></div>
			</div>
		</div>
		<div style="margin: 10px;" data-ng-if="mapperController.currentPage == 'outputs'">
			<div data-ng-controller="MapInputOutputController as inOutController" data-ng-repeat="(name, object) in selectedNode.outputs track by name">
				<div class="mapObject">
					<md-input-container class="halfWidth">
						<label>{{::'assemblyContextVariable' | translate}}</label>
						<input apim-context-variable data-ng-model="object.variable" data-ng-model-options="{debounce:200}"/>
					</md-input-container>
					<md-input-container class="halfWidth">
						<label>{{::"assemblyMapName" | translate}}</label>
						<input data-ng-model="$outputName" data-ng-model-options="{getterSetter: true, updateOn: 'blur'}"/>
					</md-input-container>
					<div style="width: 88px;"></div>
				</div>
				<div  class="mapObject">
					<div class="halfWidth">
						<label style="padding-left: 3px;" for="$id + '_outputType'">{{::"assemblyContentType" | translate}}</label>
						<apim-combobox style="font-weight: bold;" id="$id + '_outputType'" item-list="inOutController.contentTypes" selection="contentType"></apim-combobox>
					</div>
					<md-input-container class="halfWidth">
						<label for="$id + '_definition'">{{::'assemblyDefinition' | translate}}</label>
						<md-select required data-ng-model="selectedDefinition">
							<md-option data-ng-repeat="definition in definitions" data-ng-value="definition.value || definition.name">{{definition.name}}</md-option>
						</md-select>
					</md-input-container>
					<button style="margin: 10px;" data-ng-show="selectedDefinition == 'inline'" class="iconOnlyButton material-icons" data-ng-click="inOutController.launchInlineEditor()" title="{{::'assembly_edit_inline_definition' | translate}}">code</button>
					<div style="width: 44px;"  data-ng-show="selectedDefinition !== 'inline'"></div>
					<button style="margin: 10px;" class="iconOnlyButton material-icons" data-ng-click="mapperController.removeOutput(name)" title="{{::'assemblyRemoveOutput' | translate}}">delete</button>
				</div>
			</div>
			<div>
				<button data-ng-click="mapperController.addOutput()" title="{{::'assemblyAddOutputTitle' | translate}}">{{::'assemblyAddOutputTitle' | translate}}</button>
				<md-menu>
					<md-button ng-click="$mdOpenMenu($event);" title="{{::'assemblyAddOutputsTitle' | translate}}">{{::'assemblyAddOutputsTitle' | translate}}</md-button>
					<md-menu-content>
						<md-menu-item data-ng-repeat="operation in swaggerOperations">
							<span data-ng-if="operation.operationId" data-ng-click="mapperController.addOutputsForOperation(operation);">{{operation.operationId}}</span>
							<span data-ng-if="!operation.operationId" data-ng-click="mapperController.addOutputsForOperation(operation);">{{operation.verb}} {{operation.path}}</span>
						</md-menu-item>
					</md-menu-content>
				</md-menu>
				<button style="float: right;" data-ng-click="mapperController.switchToMap();" title="{{::'assemblyDone' | translate}}">{{::'assemblyDone' | translate}}</button>
			<div class="clearBoth"></div>
			</div>
		</div>
		<div style="margin: 10px;" data-ng-if="mapperController.currentPage == 'options'">
			<md-input-container>
				<label>{{::"assemblyTitle" | translate}}</label>
				<input data-ng-model="selectedNode.title" data-ng-model-options="{debounce:200}"/>
			</md-input-container>
			<md-input-container style="flex: 0.7;">
				<label>{{::"assemblyDescription" | translate}}</label>
				<textarea data-ng-model="selectedNode.description" data-ng-model-options="{debounce:200}"></textarea>
			</md-input-container>
			<label style="display: block; margin: 20px 0 10px 0;">{{::"assemblerMapperConfigureXML" | translate}}</label>
			<div>
				<md-checkbox md-no-ink aria-label="{{::'assemblerMapperIncludeEmpty' | translate}}" data-ng-model="includeEmptyXMLElements" data-ng-model-options="{'getterSetter': true}" class="flex40 md-primary">
					<span>{{::"assemblerMapperIncludeEmpty" | translate}}</span>
					<label style="display: block;">{{::"assemblerMapperIncludeEmptyDesc" | translate}}</label>
				</md-checkbox>
			</div>
			<div>
				<md-checkbox md-no-ink aria-label="{{::'assemblerMapperNamespaceInheritance' | translate}}" data-ng-model="namespaceInheritance" data-ng-model-options="{'getterSetter': true}" class="flex40 md-primary">
					<span>{{::"assemblerMapperNamespaceInheritance" | translate}}</span>
					<label style="display: block;">{{::"assemblerMapperNamespaceInheritanceDesc" | translate}}</label>
				</md-checkbox>	
			</div>
			<div>
				<md-checkbox md-no-ink aria-label="{{::'assemblerMapperNamespaceInlining' | translate}}" data-ng-model="inlineNamespaces" data-ng-model-options="{'getterSetter': true}" class="flex40 md-primary">
					<span>{{::"assemblerMapperNamespaceInlining" | translate}}</span>
					<label style="display: block;">{{::"assemblerMapperNamespaceInliningDesc" | translate}}</label>
				</md-checkbox>	
			</div>
			<button style="float: right;" data-ng-click="mapperController.switchToMap();" title="{{::'assemblyDone' | translate}}">{{::'assemblyDone' | translate}}</button>
			<div class="clearBoth"></div>
			</div>
		</div>
	</fieldset>
</div>
