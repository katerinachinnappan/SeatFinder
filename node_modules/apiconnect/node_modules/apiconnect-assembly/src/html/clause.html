<div data-ng-class="{'clauseShell': node.case, 'selectedNode': selectedNode == node, 'conditionShell': node.condition || node.execute}">
	<div class="clauseContainer" data-ng-if="node.case" data-ng-repeat="case in node.case" data-ng-controller="NodeCaseController">
		<div class="clauseRow" data-ng-class="{'otherwiseClause': !!case.otherwise}"><div class="clauseRowInner" ng-class="{'clause-row--selected': $index === node.$$selectedBranch}">
			<div class="clauseLabel" data-ng-class="{'expanded': expanded[$index]}" data-ng-click="expanded[$index] = !expanded[$index]">
				<span ng-if="!isAppConnect()">
					<button class="clauseToggle" style="" data-ng-if="collapseNodes" data-ng-click="showContent($event);">+</button>
					<button class="clauseToggle" data-ng-if="!collapseNodes" data-ng-click="hideContent($event);">-</button>
					<span>{{case | clauseMessage}}</span>
				</span>
				<span ng-if="isAppConnect()">
					<span ng-if="$first" translate="ifPanel.if"></span>
					<span ng-if="$last" translate="ifPanel.else"></span>
					<span ng-if="$middle" translate="ifPanel.elseIf"></span>
					<branch-label ng-if="!case.otherwise" condition="case.condition" node="node"></branch-label>
				</span>
			</div>
			<div data-ng-if="!collapseNodes">
				<div class="clauseIcon" data-ng-if="!case.otherwise" tabindex="0" data-ng-class="{'searchMiss': !conditionHasMatchedSearch(case), 'searchHit': conditionHasMatchedSearch(case)}" data-ng-keydown="keyPressed($event, case);" data-ng-click="nodeSelected($event, node)">
				</div><div class="dropzoneGroupSpacer">
				</div><div class="dropzoneGroup" data-ng-class="{'assembly-canvas__insert-point': allowNewNode()}" data-ui-on-drop="policyDropped($data, node, $index, -1)">
					<div class="ghostPolicy" data-ng-click="ghostSelected($event, node, $index, -1)">
							<md-icon data-ng-if="isAppConnect() && allowNewNode()" md-svg-icon="floweditor:Plus-Light" class="assembly-canvas__plus-inner"></md-icon>
					</div>
						<div ng-if="isAppConnect() && allowNewNode()" class="ghostPadder"></div>
				</div><div class="inlineContainer" data-ng-repeat="node in case.execute | transformNodeModel: policiesByType">
					<div class="inlineContainer"><apim-node></apim-node>
					</div><div class="dropzoneGroupSpacer">
					</div><div data-ng-if="node.type !== 'response' && node.type !== 'throw'" class="dropzoneGroup" data-ng-class="{'assembly-canvas__insert-point': allowNewNode()}" data-ui-on-drop="policyDropped($data, $parent.$parent.node, $parent.$parent.$index, $index)">
						<div class="ghostPolicy" data-ng-click="ghostSelected($event, $parent.$parent.node, $parent.$parent.$index, $index)">
								<md-icon data-ng-if="isAppConnect() && allowNewNode()" md-svg-icon="floweditor:Plus-Light" class="assembly-canvas__plus-inner"></md-icon>
						</div>
							<div ng-if="isAppConnect() && allowNewNode()" class="ghostPadder"></div>
					</div>
				</div><div class="inlineContainer" data-ng-repeat="node in case.otherwise | transformNodeModel: policiesByType">
					<div class="inlineContainer"><apim-node></apim-node>
					</div><div class="dropzoneGroupSpacer">
					</div><div data-ng-if="node.type !== 'response' && node.type !== 'throw'" class="dropzoneGroup" data-ng-class="{'assembly-canvas__insert-point': allowNewNode()}" data-ui-on-drop="policyDropped($data, $parent.$parent.node, $parent.$parent.$index, $index)">
						<div class="ghostPolicy" data-ng-click="ghostSelected($event, $parent.$parent.node, $parent.$parent.$index, $index)">
								<md-icon data-ng-if="isAppConnect() && allowNewNode()" md-svg-icon="floweditor:Plus-Light" class="assembly-canvas__plus-inner"></md-icon>
						</div>
							<div ng-if="isAppConnect() && allowNewNode()" class="ghostPadder"></div>
					</div>
				</div>
				<div class="clauseRowTerminator">
					<div class="clause-row__map-button-wrapper">
						<div class="clause-row__map-button-tooltip-wrapper" ng-show="!hasOutputSchema(node)">
							<md-tooltip>{{"ifPanel.outputSchemaCanvasTooltip" | translate}}</md-tooltip>
						</div>
						<md-button ng-if="isAppConnect()" ng-click="expandBranch($event, node, $index)" ng-class="{'clause-row__map-button--active': $index === node.$$expandedBranch}" class="iconOnlyButton clause-row__map-button">
							<md-icon md-svg-icon="floweditor:output-data"></md-icon>
						</md-button>
					</div>
				</div>
			</div>
		</div>
	</div>
	</div>
	<div class="clauseContainer conditionContainer" data-ng-if="node.condition || node.execute">
		<div class="clauseRow"><div class="clauseRowInner">
			<div class="clauseLabel" data-ng-class="{'expanded': expanded[$index]}" data-ng-click="expanded[$index] = !expanded[$index]">{{node.condition}}</div>
			<div class="clauseIcon" data-ng-show="node.condition" data-ng-class="{'searchMiss': !conditionHasMatchedSearch(node.condition), 'searchHit': conditionHasMatchedSearch(node.condition)}" data-ng-keydown="$event.stopPropagation();" data-ng-click="$event.stopPropagation();" data-popover="{{node | clauseMessage}}" data-popover-placement="left" data-popover-trigger="focus" data-popover-animation="true">
			</div><div class="dropzoneGroupSpacer">
			</div><div class="dropzoneGroup" data-ui-on-drop="policyDropped($data, node, 0, -1)">
				<div class="ghostPolicy"></div>
			</div><div class="inlineContainer" data-ng-repeat="node in node.execute | transformNodeModel: policiesByType">
				<div class="inlineContainer"><apim-node></apim-node>
				</div><div class="dropzoneGroupSpacer">
				</div><div data-ng-if="node.type !== 'response' && node.type !== 'throw'" class="dropzoneGroup" data-ui-on-drop="policyDropped($data, $parent.$parent.node, 0, $index)">
					<div class="ghostPolicy"></div>
				</div>
			</div>
		</div></div>
	</div>
	<span data-ng-if="node.case" class="clauseDropzoneGroup" data-ng-class="{'clause-dropzone-group--hidden': node.case.length > 9}" data-ui-on-drop="policyDropped($data, node, -1)">
		<div class="clauseGhost"></div>
	</span>
</div>
