crypto
  {{#if publicKeyCert}}
  certificate "{{publicKeyCert._name}}" "{{publicKeyCert.url}}" ignore-expiration
  {{/if}}
  {{#each trustStores}}
  certificate "{{_name}}" "{{url}}" ignore-expiration
  {{/each}}
  
  {{#if privateKey}}
  key "{{privateKey._name}}" "{{privateKey.url}}"
  idcred "{{_name}}-idcred" "{{privateKey._name}}" "{{publicKeyCert._name}}"
  {{/if}}

  {{#if (gt trustStores.length 0)}}
  valcred {{_name}}-valcred
    reset
    {{#each trustStores}}
    certificate {{_name}}
    {{/each}}
    cert-validation-mode "legacy"
    use-crl "on"
    require-crl "off"
    crldp "ignore"
    explicit-policy "off"
    check-dates "on"
  exit
  {{/if}}

  ssl-client {{_name}}
    reset
    protocols {{protocols}}
    {{#each ciphers}}
    ciphers {{this}}
    {{/each}}
    {{#if privateKey}}
    idcred {{_name}}-idcred
    {{/if}}
    {{#if mutualAuth}}
    validate-server-cert
    valcred {{_name}}-valcred
    {{^}}
    no validate-server-cert
    {{/if}}
    caching
    cache-timeout 300   {{~! do these come from somewhere? }}
    cache-size 100      {{~! do these come from somewhere? }}
    ssl-client-features "{{#if useSNI}}use-sni{{/if}}"
    curves secp521r1
    curves secp384r1
    curves secp256k1
    curves secp256r1
    use-custom-sni-hostname no  {{~! FIXME Is this supposed to be dependent on anything? }}
  exit
exit
