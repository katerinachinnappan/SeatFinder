{{!--
/********************************************************* {COPYRIGHT-TOP} ***
  * Licensed Materials - Property of IBM
  * 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
  *
  * (C) Copyright IBM Corporation 2017
  *
  * All Rights Reserved.
  * US Government Users Restricted Rights - Use, duplication or disclosure
  * restricted by GSA ADP Schedule Contract with IBM Corp.
  ********************************************************** {COPYRIGHT-END} **/
--}}

swagger: '2.0'
info:
  version: 1.0.0
  title: OAuth API for the provider of {{name}}
  x-ibm-name: oauth-provider-settings-{{name}}
host: $(catalog.host)
basePath: {{basePath}}
securityDefinitions:
  {{#if (and apic-authorize-endpoint
            (or (-contains 'accessCode' grants) 
                (-contains 'implicit' grants)))}}
  clientIdInQuery:
    type: apiKey
    in: query
    name: client_id
    x-key-type: clientId
  basicAuth:
    type: basic
    description: 'Add your basic url and tls-profile below'
    x-ibm-authentication-url:
      url: https://httpbin.org/basic-auth/testuser/testpw
      tls-profile: 
  {{/if}}
  clientIdInFormData:
    type: apiKey
    in: formData
    name: client_id
    x-key-type: clientId
  clientSecretInFormData:
    type: apiKey
    in: formData
    name: client_secret
    x-key-type: clientSecret
paths:
  {{#if (and apic-authorize-endpoint
            (or (-contains 'accessCode' grants) 
                (-contains 'implicit' grants)))}}
  {{apic-authorize-endpoint}}:
    get:
      responses:
        '200':
          description: OK
      parameters:
        - name: response_type
          in: query
          required: true
          type: string
        - name: client_id
          in: query
          required: true
          type: string
        - name: redirect_uri
          in: query
          required: false
          type: string
        - name: scope
          in: query
          required: false
          type: string
        - name: state
          in: query
          required: false
          type: string
      security:
        - clientIdInQuery: []
          basicAuth: []
      produces: []
    post:
      responses:
        '200':
          description: OK
      parameters:
        - name: response_type
          in: formData
          required: true
          type: string
        - name: client_id
          in: formData
          required: true
          type: string
        - name: redirect_uri
          in: formData
          required: false
          type: string
        - name: scope
          in: formData
          required: false
          type: string
        - name: state
          in: formData
          required: false
          type: string
      security:
        - clientIdInFormData: []
          basicAuth: []
      consumes:
        - application/x-www-form-urlencoded
      produces: []
  {{/if}}
  {{#if apic-token-endpoint}}
  {{apic-token-endpoint}}:
    post:
      responses:
        '200':
          description: OK
      parameters:
        - name: grant_type
          in: formData
          required: true
          type: string
        - name: client_id
          in: formData
          required: true
          type: string
        - name: client_secret
          in: formData
          required: false
          type: string
        - name: scope
          in: formData
          required: false
          type: string
        - name: code
          in: formData
          required: false
          type: string
        - name: redirect_uri
          in: formData
          required: false
          type: string
      security:
        - clientIdInFormData: []
          clientSecretInFormData: []
  {{/if}}
  {{#if (and apic-enable-introspection apic-introspect-endpoint) }}
  {{apic-introspect-endpoint}}:
    post:
      responses:
        '200':
          description: OK
      parameters:
        - name: token
          in: formData
          required: true
          type: string
        - name: token_type_hint
          in: formData
          required: false
          type: string
      security:
        - clientIdInFormData: []
          clientSecretInFormData: []
  {{/if}}
schemes:
  - https
consumes:
  - application/x-www-form-urlencoded
produces:
  - application/json
x-ibm-configuration:
  gateway: datapower-gateway
  assembly:
    execute:
      - oauth-generate:
          provider: {{name}}
          url: ''
          literal: ''
