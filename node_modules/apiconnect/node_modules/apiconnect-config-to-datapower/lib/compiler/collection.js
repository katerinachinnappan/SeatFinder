/********************************************************* {COPYRIGHT-TOP} ***
 * Licensed Materials - Property of IBM
 * 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
 *
 * (C) Copyright IBM Corporation 2017
 *
 * All Rights Reserved.
 * US Government Users Restricted Rights - Use, duplication or disclosure
 * restricted by GSA ADP Schedule Contract with IBM Corp.
 ********************************************************** {COPYRIGHT-END} **/

// Node module: apiconnect-config-to-datapower

'use strict';

const coname = require('./coname');

module.exports = exports = (options, plans, subscriptions) => {
  function APICollection() {
    this._name = coname.collection(options);
    this.routingPrefix = options.routingPrefix;
    this.plans = plans;

    let subs = (subscriptions || []).reduce((r, s) => {
      let plan = s._plan;
      s = r[s._name] || s;
      s.plans.push(plan);
      r[s._name] = s;
      return r;
    }, {});
    this.subscriptions = Object.keys(subs).map(n => subs[n]);
  }

  return new APICollection();
};
