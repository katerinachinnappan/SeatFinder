/********************************************************* {COPYRIGHT-TOP} ***
 * Licensed Materials - Property of IBM
 * 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
 *
 * (C) Copyright IBM Corporation 2016, 2017
 *
 * All Rights Reserved.
 * US Government Users Restricted Rights - Use, duplication or disclosure
 * restricted by GSA ADP Schedule Contract with IBM Corp.
 ********************************************************** {COPYRIGHT-END} **/
// Node module: apiconnect-cli-pm

'use strict';

var Promise = require('bluebird');
var _ = require('lodash');
var errors = require('./util/errors');
var names = require('./util/name-helper');

module.exports = clearProps;

function clearProps(options) {
  options = options || {};
  var namesPromise = Promise.resolve(options.service);
  if (!options.service) {
    namesPromise = names(null, true);
  }

  var client = require('./util/client').init(options);
  return namesPromise.then(function(serviceName) {
    if (!serviceName) {
      throw errors.nonProjectDir('apic props:clear');
    }
    return client.getService(serviceName);
  }).then(function(service) {
    var propNames = _.keys(service.env);
    return require('./props-delete')('', propNames, options);
  });
}

