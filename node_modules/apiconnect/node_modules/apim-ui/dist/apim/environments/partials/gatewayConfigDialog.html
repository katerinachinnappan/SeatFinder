<!--
/********************************************************* {COPYRIGHT-TOP} ***
* Licensed Materials - Property of IBM
* 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
*
* (C) Copyright IBM Corporation 2017
*
* All Rights Reserved.
* US Government Users Restricted Rights - Use, duplication or disclosure
* restricted by GSA ADP Schedule Contract with IBM Corp.
********************************************************** {COPYRIGHT-END} **/
-->
<h2 class="bx--modal-content__heading" id="{{$id}}_bannerHeading">{{::'gatewayConfigureTitle' | translate}}</h2>
<button title="Close" class="bx--modal__close" type="button" data-ng-click="cancel();" tabindex="-1">
  <bx-icon class="bx--modal__close--icon" icon="close"></bx-icon>
</button>
<div class="bx--modal-content gatewayDialog" data-ng-switch="currentPage">
  <form name="gatewayForm" class="bx--form">
    <div data-ng-class="{'spinner': fetchingData}" data-ng-show="fetchingData"></div>
    <div data-ng-show="!fetchingData">
      <div data-ng-switch-default>
        <div>{{::'gatewaySelectGatewayCollective' | translate}}</div>
        <div class="gatewayListBox">
          <div class="gatewayListSection">{{::'gatewayServices' | translate}}</div>
          <div class="gatewayEmpty" data-ng-if="!gatewayClusters || gatewayClusters.length == 0">{{::'gatewayEmptyServices' | translate}}</div>
          <ul>
            <li class="gatewayListItem" data-ng-repeat="gateway in gatewayClusters" tabindex="0" data-ng-controller="GatewaySelectorController">
              <md-checkbox style="margin: 10px;" md-no-ink aria-label="{{gateway.name}}" data-ng-model="$selected" data-ng-model-options="{getterSetter:true}" class="md-primary">
                {{gateway.name}}
              </md-checkbox>
              <span class="tag--beta appLifecycleTag" ng-class="'appLifecycle-'+type" data-ng-repeat="type in gateway.type.sort()">{{type | applicationType}}</span>
            </li>
          </ul>
          <div class="gatewayListSection">{{::'gatewayCollectives' | translate}}</div>
          <div class="gatewayEmpty" data-ng-if="!collectives || collectives.length == 0">{{::'gatewayEmptyCollectives' | translate}}</div>
          <ul>
            <li class="gatewayListItem" data-ng-repeat="collective in collectives" data-ng-click="selectCollective(collective)" data-ng-class="{selected: data.selectedCollective == collective.id}" tabindex="0">
              {{collective.title}}
            </li>
          </ul>
          <div data-ng-show="features.standaloneMicroGateway">
            <div class="gatewayListSection">{{::'gatewayMicroGatewayServices' | translate}}</div>
            <ul>
              <li class="gatewayListItem" data-ng-click="selectStandaloneMicroGateway()" data-ng-class="{selected: data.selectedStandaloneMicroGateway}" tabindex="0">
                {{'gatewayApiconnectStandaloneMicroGateway' | translate}}
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div data-ng-switch-when="2">
        <div data-ng-show="data.selectedCollective">
          <div>{{::'gatewaySelectApplication' | translate}}</div>
          <div class="gatewayListBox">
            <div class="gatewayEmpty" data-ng-if="!appList || appList.length == 0">{{::'gatewayEmptyApps' | translate}}</div>
            <ul>
              <li class="gatewayListItem" data-ng-repeat="app in appList" data-ng-click="data.selectedApplication = app.id" data-ng-class="{selected: data.selectedApplication == app.id}" tabindex="0">
                {{app.name}}
              </li>
            </ul>
          </div>
        </div>
        <div class="topMargin verticalPad">{{::'gatewayEnterPublicKey' | translate}}</div>
        <bx-input-container class="md-block">
          <label data-ng-class="{'bx--form__label-required': currentPage == 2}">{{::'gatewayPublicKey' | translate}}</label>
          <textarea rows="5" data-ng-model="data.publicKey" data-ng-required="currentPage == 2"></textarea>
        </bx-input-container>
      </div>
    </div>
  </form>
</div>
<div class="bx--modal__buttons" role="contentinfo" aria-label="{{'footerSectionLabel' | translate}}">
  <div class="bx--modal__buttons-container floatLeft">
    <button class="bx--btn--secondary floatLeft no-animate" data-ng-show="currentPage >= 2" data-ng-disabled="savingData" data-ng-click="currentPage = 1">{{::'gatewayBack' | translate}}</button>
  </div>
  <div class="bx--modal__buttons-container">
    <div class="loadingAnimate" data-ng-show="savingData"></div>
    <button class="bx--btn--secondary" data-ng-disabled="savingData" data-ng-click="cancel()">{{::'cancel' | translate}}</button>
    <button class="bx--btn no-animate" data-ng-show="currentPage == 1 && (data.selectedCollective || data.selectedStandaloneMicroGateway)" data-ng-disabled="savingData || !gatewayForm.$valid" data-ng-click="doNext()">{{::'gatewayNext' | translate}}</button>
    <button class="bx--btn no-animate" data-ng-show="(currentPage == 1 && hasSelectedGateways) || currentPage == 2"
            data-ng-disabled="!gatewayForm.$valid || (currentPage == 2 && data.selectedCollective && !data.selectedApplication) || (currentPage == 1 && !data.selectedCollective && !data.selectedGateway.length === 0 && !data.selectedStandaloneMicroGateway) || savingData" data-ng-click="save()">{{::'done' | translate}}</button>
  </div>
</div>
