<!--
/********************************************************* {COPYRIGHT-TOP} ***
* Licensed Materials - Property of IBM
* 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
*
* (C) Copyright IBM Corporation 2017
*
* All Rights Reserved.
* US Government Users Restricted Rights - Use, duplication or disclosure
* restricted by GSA ADP Schedule Contract with IBM Corp.
********************************************************** {COPYRIGHT-END} **/
-->
<div class="mediumPadding">
	<div class="bx--form__fieldset">
		<div class="bx--form__legend">{{::'portalConfiguration' | translate}}</div>
		<div class="bx--form__row-item">
			<div class="bx--select">
				<label for="{{$id}}_portalType" class="bx--form__label">{{::'portalSelectPortal' | translate}}</label>
				<select id="{{$id}}_portalType" class="bx--select__input" data-ng-model="selectedEnvironment.portalType" data-ng-options="type.value as type.name for type in portalTypes" data-ng-change="advancePortalChanged()" data-ng-disabled="!permissions[selectedEnvironment.id + '/catalog_catalogSettings/manage'] || spaceId">
				</select>
				<bx-icon class="bx--select__arrow" icon="caret--down"></bx-icon>
			</div>
		</div>
		<div class="bx--form__row-item">
			<div class="greyBorderTopBottom" data-ng-show="isPublicSaaS && selectedEnvironment.portalType == 'ADVANCED'" style="padding: 5px 0px;" data-ng-class="{'greyText': selectedEnvironment.portalType != 'ADVANCED'}">
				{{::'portalURL' | translate}}: <a href="{{selectedEnvironment.advPortalUrl}}" target="_blank">{{selectedEnvironment.advPortalUrl}}</a>
			</div>
			<p data-ng-show="!isPublicSaaS && selectedEnvironment.portalType != 'BASIC'">{{::'portalURLInformation' | translate}}</p>
			<div class="" data-ng-show="!isPublicSaaS && selectedEnvironment.portalType != 'BASIC'">
				<bx-input-container>
					<label>{{::'urlTitle' | translate}}</label>
					<input type="url" data-ng-model="selectedEnvironment.customPortalUrl" data-ng-disabled="!permissions[selectedEnvironment.id + '/catalog_catalogSettings/manage'] || spaceId" data-ng-pattern="portalUrlRegEx"/>
				</bx-input-container>
			</div>

		</div>
	</div>
  <div class="stickyNote" data-ng-show="selectedEnvironment.portalType == 'ADVANCED' && isPublicSaaS && advancePortalConfirmed">{{::'bluemixEnabledConfirmation' | translate}}</div>

	<div class="webapiFormRow topExtraMargin bx--form__row-item" data-ng-if="features.applicationLifecycle">
		<md-switch class="md-primary" data-md-no-ink data-ng-model="$applicationLifecycleEnabled" data-ng-model-options="{getterSetter:true}" data-ng-disabled="!permissions[selectedEnvironment.id + '/catalog_catalogSettings/manage'] || spaceId" aria-label="{{::'environmentApplicationLifecycle' | translate}}">{{::'environmentApplicationLifecycle' | translate}}</md-switch>
		<p class="switchIndent">{{::'environmentApplicationLifecycleDescription' | translate}}</p>
	</div>

	<!-- User registration -->
	<div class="bx--form__legend">{{::'userRegistrationAndInvitation' | translate}}</div>
	<div class="bx--form__row-item">
		<h6>{{::'environmentIdentityProvider' | translate}}</h6>
		<div class="dijitInline dropdown registryMenu" data-is-open="environmentUserRegistryMenuIsOpen" dropdown>
			<button role="button" class="iconOnlyButton dropdown-toggle" dropdown-toggle data-ng-disabled="!permissions[selectedEnvironment.id + '/catalog_catalogSettings/manage'] || spaceId">
				<span class="highlightText">{{selectedEnvironment.idp | getPropertyFromId:registries:'id':'title':'name'}}</span><span class="caret"></span>
			</button>
			<ul class="dropdown-menu pull-right" role="menu" aria-label="{{::'environmentIdentityProvider' | translate}}" tabindex="0" onkeypress="environmentUserRegistryMenuIsOpen = true;">
				<li role="menuitem" class="registryMenuItem" data-ng-repeat="registry in registries | registryTypeFilter:selectedEnvironment.portalType"><a href="javascript:void(0)" data-ng-click="userRegistryChanged(registry)">{{registry.title ? registry.title : registry.name}}</a></li>
				<li class="registryMenuItem divider" data-ng-show="permissions['org_organizationManagement/manage']"></li>
				<li role="menuitem" class="registryMenuItem" data-ng-show="permissions['org_organizationManagement/manage']"><a href="javascript:void(0)" data-ng-click="newLdapProfile()">{{::'newLdapProfile' | translate}}</a></li>
				<li role="menuitem" class="registryMenuItem" data-ng-show="permissions['org_organizationManagement/manage']"><a href="javascript:void(0)" data-ng-click="newAuthUrlProfile()">{{::'newAuthUrlRegistry' | translate}}</a></li>
				<li role="menuitem" class="registryMenuItem" data-ng-show="permissions['org_organizationManagement/manage']"><a href="javascript:void(0)" data-ng-click="newLocalProfile()">{{::'newDatabase' | translate}}</a></li>
				<li role="menuitem" class="registryMenuItem" data-ng-show="permissions['org_organizationManagement/manage'] && selectedEnvironment.portalType != 'BASIC'"><a href="javascript:void(0)" data-ng-click="newScimProfile()">{{::'newScimUserRegistry' | translate}}</a></li>
			</ul>
		</div>
	</div>
	<div class="bx--form__row-item ">
		<md-switch class="md-primary" data-md-no-ink data-ng-model="selectedEnvironment.invitationEnabled" data-ng-disabled="!permissions[selectedEnvironment.id + '/catalog_catalogSettings/manage'] || spaceId" aria-label="{{::'developersCanInviteCollaborators' | translate}}">{{::'developersCanInviteCollaborators' | translate}}</md-switch>
	</div>
	<div class="bx--form__row-item switchIndent">
		<fieldset title="{{::'userRoles' | translate}}">
			<legend class="apiScreenReaderOnly" title="{{::'userRoles' | translate}}">{{::'userRoles' | translate}}</legend>
			<bx-radio-group data-ng-model="$collaboratorRoles" aria-label="{{::'portal' | translate}}" data-ng-model-options="{'getterSetter': true}">
			  <bx-radio-button value='viewer' data-ng-disabled="!selectedEnvironment.invitationEnabled || !permissions[selectedEnvironment.id + '/catalog_catalogSettings/manage'] || spaceId" data-label-text="{{::'roleViewer' | translate}}"></bx-radio-button>
  			<div class="radioIndent">{{::'roleViewerDescription' | translate}}</div>
	  		<bx-radio-button value='developer' data-ng-disabled="!selectedEnvironment.invitationEnabled || !permissions[selectedEnvironment.id + '/catalog_catalogSettings/manage'] || spaceId" data-label-text="{{::'roleDeveloper' | translate}}"></bx-radio-button>
  			<div class="radioIndent">{{::'roleDeveloperDescription' | translate}}</div>
	  		<bx-radio-button value='viewer_developer' data-ng-disabled="!selectedEnvironment.invitationEnabled || !permissions[selectedEnvironment.id + '/catalog_catalogSettings/manage'] || spaceId" data-label-text="{{::'rolesViewerAndDeveloper' | translate}}"></bx-radio-button>
	    </bx-radio-group>
		</fieldset>
	</div>
	<div class="bx--form__row-item">
		<md-switch data-ng-hide="isPortalIDP()" class="md-primary" data-md-no-ink data-ng-model="selectedEnvironment.selfSignUpEnabled" data-ng-disabled="isScim() || !permissions[selectedEnvironment.id + '/catalog_catalogSettings/manage'] || spaceId" aria-label="{{::'selfServiceOnboarding' | translate}}">{{::'selfServiceOnboarding' | translate}}</md-switch>
		<span data-ng-show="isPortalIDP()">{{::"selfServiceControleldInPortal" | translate}}</span>
	</div>

	<div class="bx--form__fieldset" data-ng-show="selectedEnvironment.portalType === 'OTHER'">
		<div class="bx--form__legend">{{::'portalApiEndpoint' | translate}}</div>
		<bx-input-container style="margin-top: 10px;">
			<label>{{::'hostnameDevPortalAPICalls' | translate}}</label>
			<input type="text" data-ng-model="selectedEnvironment.apimRestDnsHost" data-ng-disabled="!permissions[selectedEnvironment.id + '/catalog_catalogSettings/manage'] || spaceId" />
		</bx-input-container>
	</div>
</div>
