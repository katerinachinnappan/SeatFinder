<!--
/********************************************************* {COPYRIGHT-TOP} ***
* Licensed Materials - Property of IBM
* 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
*
* (C) Copyright IBM Corporation 2017
*
* All Rights Reserved.
* US Government Users Restricted Rights - Use, duplication or disclosure
* restricted by GSA ADP Schedule Contract with IBM Corp.
********************************************************** {COPYRIGHT-END} **/
-->

<section class="spacesCollection centerColumn absolutelyFabulous" data-ng-controller="EnvironmentSpacesController as environmentSpacesController">
  <div data-ng-class="{'spinner': (!envChecked || !spacesLoaded)}"></div>
  <div data-ng-show="envChecked && spacesLoaded">
    <div class="actionSection apiSelfClear">
      <span class="actionLabel">{{::'env_spaces_title' | translate}}</span>
    </div>
    <div class="apiSelfClear whiteBackground layout fullWidth searchBanner">
      <button class="bx--btn" title="{{::'env_add_spaces_title' | translate}}" data-ng-click="addSpace()" data-ng-show="permissions[environment.id + '/catalog_spaces/create']">
        {{::'add' | translate}}
        <bx-icon class="bx--btn--right-icon__icon" icon="add--glyph"></bx-icon>
      </button>
			<div class="displayInline itsAllRelative flex bx--search" role="search">
          <bx-icon class="bx--search__icon--magnifier" icon="search"></bx-icon>
          <label for="search__input" class="bx--search__label">{{::'env_search_spaces' | translate}}</label>
          <input type="search" class="bx--search__input" id="search__input" aria-label="{{::'env_search_spaces' | translate}}" placeholder="{{::'env_search_spaces' | translate}}" data-ng-model="query" />
          <button type="reset" class="iconOnlyButton" data-ng-click="$parent.query = '';" data-ng-show="query" title="{{::'resetFilter' | translate}}"><div class="closeIcon"></div></button>
			</div>
		</div>
  </div>

  <div class="secondaryBackground bx--space_table">
    <div class="bx--responsive-table-container">
      <table class="bx--responsive-table">
        <thead class="bx--table-head">
          <tr class="bx--table-row">

            <th class="bx--table-header bx--table-sort bxTablePaddingLeft" ng-class="{'bx--table-sort--ascending' : orderDirection, 'bx--table-sort-active' : orderProp == 'title'}" data-ng-click="orderProp = 'title'; orderDirection = !orderDirection;">
              <span>{{::'displayName' | translate}}</span>
              <bx-icon class="bx--table-sort__svg" icon="caret--down"></bx-icon>
            </th>

           <th class="bx--table-header bx--table-sort" ng-class="{'bx--table-sort--ascending' : orderDirection, 'bx--table-sort-active' : orderProp == 'name'}" data-ng-click="orderProp = 'name'; orderDirection = !orderDirection;">
              <span>{{::'name' | translate}}</span>
              <bx-icon class="bx--table-sort__svg" icon="caret--down"></bx-icon>
            </th>

           <th class="bx--table-header bx--table-sort" ng-class="{'bx--table-sort--ascending' : orderDirection, 'bx--table-sort-active' : orderProp == 'owner'}" data-ng-click="orderProp = 'owner'; orderDirection = !orderDirection;">
              <span>{{::'owner' | translate}}</span>
              <bx-icon class="bx--table-sort__svg" icon="caret--down"></bx-icon>
            </th>

           <th class="bx--table-header bx--table-sort" ng-class="{'bx--table-sort--ascending' : orderDirection, 'bx--table-sort-active' : orderProp == 'createAt'}" data-ng-click="orderProp = 'createAt'; orderDirection = !orderDirection;">
              <span>{{::'env_created_on' | translate}}</span>
              <bx-icon class="bx--table-sort__svg" icon="caret--down"></bx-icon>
            </th>

            <th class="bx--table-header bxTablePaddingRight"></th>
          </tr>
        </thead>
        <tbody class="bx--table-body">

          <tr class="bx--table-row bx--parent-row bxTablePaddingLeft" data-ng-show="spaces && spaces.length === 0">
            <td colspan="5">{{::'env_spaces_none' | translate}}</td>
          </tr>

          <tr class="bx--table-row bx--parent-row bxTablePaddingLeft" data-ng-show="spaces && spaces.length > 0 && filteredSpaces.length === 0">
            <td colspan="5">{{::'env_spaces_none_matching' | translate}}</td>
          </tr>

          <tr class="bx--table-row bx--parent-row" ng-class-even="'bx--parent-row--even'" data-ng-controller="EnvironmentSpaceController" data-ng-repeat="space in filteredSpaces = (spaces | spacesQuery: query | orderBy: orderProp: orderDirection)">

            <td class="bxTablePaddingLeft" data-ng-bind-html="space.title | highlight: query"></td>
            <td data-ng-bind-html="space.name | highlight: query"></td>
            <td data-ng-bind-html="space.owner.username | highlight: query"></td>
            <td>{{space.createdAt | dateformat:"L":true}}</td>
            <td class="bx--table-overflow bxTablePaddingRight">
              <div class="dropdown actionMenu" dropdown data-is-open="menuOpen" data-ng-show="permissions[environment.id + '/catalog_catalogSettings/manage']">
                <div class="absolute_overflow">
                  <bx-overflow-menu>

                    <bx-overflow-menu-item item-text="{{::'edit' | translate}}" data-ng-click="editSpace();">
                    </bx-overflow-menu-item>

                    <bx-overflow-menu-item item-text="{{::'change_owner' | translate}}" data-ng-click="changeSpaceOwner();">
                    </bx-overflow-menu-item>

                    <bx-overflow-menu-item item-text="{{::'ttDelete' | translate}}" data-ng-click="deleteSpace();">
                    </bx-overflow-menu-item>

                  </bx-overflow-menu>
                </div>

              </div>

            </td>


        </tbody>
      </table>
    </div>
  </div>

</section>
