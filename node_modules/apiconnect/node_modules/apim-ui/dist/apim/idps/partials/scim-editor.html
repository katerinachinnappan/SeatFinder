<!--
/********************************************************* {COPYRIGHT-TOP} ***
* Licensed Materials - Property of IBM
* 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
*
* (C) Copyright IBM Corporation 2017
*
* All Rights Reserved.
* US Government Users Restricted Rights - Use, duplication or disclosure
* restricted by GSA ADP Schedule Contract with IBM Corp.
********************************************************** {COPYRIGHT-END} **/
-->
<div class="scimEditor bx--form_dialog-medium-height" data-ng-controller="SCIMCtrl as scimController">
	<form name="scimForm">
		<div class="webapiFormRow layout bx--form__row">
			<div class="bx--form__row-item">
				<label class="bx--form__label mandatory bx--form__label">{{::'displayName' | translate}}</label>
				<input class="bx--text__input" type="text" data-ng-model="selectedIDP.title" data-ng-pattern="/^[\w :\/_\-:\.\<\>\{\}\[\]\(\)]+$/" apim-auto-focus required data-ng-disabled="!permissions['org_organizationManagement/manage'] || (!isDialog && !selectedIDP.orgId)" />
			</div>

			<div data-ng-if="!isDialog" class="bx--form__row-item">
				<label class="bx--form__label">{{::'idpType' | translate}}</label>
				<input class="bx--text__input" type="text" value="{{idpTypeLookup[selectedIDP.type]}}" readonly />
			</div>
		</div>

		<div class="webapiFormRow layout bx--form__row">
			<div class="bx--form__row-item">
				<label class="bx--form__label mandatory">{{::'idpNameLabel' | translate}}</label>
				<input class="bx--text__input" type="text" data-ng-model="selectedIDP.name" data-ng-pattern="/^[A-Za-z0-9_\-]+$/" data-ng-disabled="!permissions['org_organizationManagement/manage'] || (!isDialog && !selectedIDP.orgId)" required />
			</div>
		</div>

		<div class="webapiFormRow layout bx--form__row">
			<div class="bx--form__row-item">
				<label class="bx--form__label mandatory">{{::'idpRealm' | translate}}</label><button class="iconOnlyButton" title="{{::'idpRealm' | translate}}" tooltip="{{::'scimAuthUrlNameTip' | translate}}"><div class="material-icons infoIcon">info</div></button>
				<input class="bx--text__input" type="text" data-ng-model="selectedIDP.realm" data-ng-pattern="/^[\w\s]/" data-ng-minlength="1" data-ng-maxlength="64" required data-ng-disabled="!permissions['org_organizationManagement/manage'] || (!isDialog && !selectedIDP.orgId)" />
			</div>
		</div>

		<div class="webapiFormRow layout bx--form__row">
			<div class="bx--form__row-item">
				<label class="bx--form__label">{{::'scimDescription' | translate}}</label>
				<input class="bx--text__input" type="text" data-ng-model="selectedIDP.description" data-ng-disabled="!permissions['org_organizationManagement/manage'] || (!isDialog && !selectedIDP.orgId)" />
			</div>
		</div>

		<div class="webapiFormRow layout bx--form__row">
			<div class="bx--form__row-item">
				<label class="bx--form__label mandatory">{{::'scimHostname' | translate}}</label>
				<input class="bx--text__input" type="text" data-ng-model="selectedIDP.scimConfig.host" required data-ng-disabled="!permissions['org_organizationManagement/manage'] || (!isDialog && !selectedIDP.orgId)" />
      </div>

			<div class="bx--form__row-item">
				<label class="bx--form__label mandatory">{{::'scimPort' | translate}}</label>
				<input class="bx--text__input" type="text" data-ng-model="selectedIDP.scimConfig.port" data-ng-pattern="/^[\d]+$/" data-ui-validate="'validatePort($value)'" required data-ng-disabled="!permissions['org_organizationManagement/manage'] || (!isDialog && !selectedIDP.orgId)" />
			</div>
		</div>

		<div class="webapiFormRow topMargin bx--form__row">
      <div class="bx--form__row-item">
        <md-switch class="md-primary" data-md-no-ink data-ng-model="selectedIDP.scimConfig.ssl" aria-label="{{::'scimSSLToggleLabel' | translate}}" data-ng-disabled="!permissions['org_organizationManagement/manage'] || (!isDialog && !selectedIDP.orgId)">
          {{::'scimSSLToggleLabel' | translate}}
        </md-switch>
      </div>
		</div>

		<div class="webapiFormRow layout bx--form__row">
			<div class="bx--form__row-item">
				<label class="bx--form__label mandatory">{{::'scimContextRootLabel' | translate}}</label>
				<input class="bx--text__input" type="text" data-ng-model="selectedIDP.scimConfig.contextRoot" required data-ng-disabled="!permissions['org_organizationManagement/manage'] || (!isDialog && !selectedIDP.orgId)" />
			</div>
		</div>

		<div class="webapiFormRow layout bx--form__row">
			<div class="bx--form__row-item">
				<label class="bx--form__label">{{::'username' | translate}}</label>
				<input class="bx--text__input" type="text" data-ng-model="selectedIDP.scimConfig.scimAdminUser" data-ng-disabled="!permissions['org_organizationManagement/manage'] || (!isDialog && !selectedIDP.orgId)" />
      </div>

			<div class="bx--form__row-item">
				<label class="bx--form__label">{{::'password' | translate}}</label>
				<input class="bx--text__input" type="password" data-ng-model="selectedIDP.scimConfig.scimAdminPassword" data-ng-disabled="!permissions['org_organizationManagement/manage'] || (!isDialog && !selectedIDP.orgId)" />
			</div>
		</div>

		<div class="webapiFormRow layout bx--form__row">
			<div class="bx--form__row-item">
				<label class="bx--form__label mandatory">{{::'scimAuthUrl' | translate}}</label>
				<input class="bx--text__input" type="text" data-ng-model="selectedIDP.scimConfig.authenticationUrl" required data-ng-disabled="!permissions['org_organizationManagement/manage'] || (!isDialog && !selectedIDP.orgId)" />
			</div>
		</div>

	</form>

  <div class="topExtraMargin" data-ng-if="permissions['org_organizationManagement/manage'] && (isDialog || selectedIDP.orgId)">
    <div data-ng-if="!isDialog">
      <button data-ng-click="showTestConnection()" class="bx--btn bx--btn--sm" type="button" data-ng-disabled="scimForm.$invalid">{{::'testConnectionLabel' | translate}}</button>
    </div>
    <div data-ng-if="isDialog">
      <button data-ng-click="openTest()" class="bx--btn bx--btn--sm" type="button" data-ng-disabled="ldapForm.$invalid" data-ng-show="!revealTest">{{::'testConnectionLabel' | translate}}</button>
      <form class="testConnectionForm" name="testConnectionForm" data-ng-show="revealTest">
        <p>{{::'testConnectionText' | translate}}</p>

        <div class="layout bx--form__row">
          <div class="bx--form__row-item">
            <label class="bx--form__label mandatory">{{::'username' | translate}}</label>
            <input type="text" class="bx--text__input mediumWidth" data-ng-model="testDetails.testUsername" data-ng-disabled="performingTest" required />
          </div>

          <div class="bx--form__row-item">
            <label class="bx--form__label mandatory">{{::'password' | translate}}</label>
            <input type="password" class="bx--text__input mediumWidth" data-ng-model="testDetails.testPassword" data-ng-disabled="performingTest" required />
          </div>
        </div>
        <p id="{{$id}}_statusText" class="error" data-ng-show="testFailed">{{::'idpConnectionFail' | translate}}</p>
        <div class="webapiFormRow layout bx--form__row bx--form__row--column">
          <div class="bx--form__row-item bx--sets-of-buttons innerButtons">
            <button id="{{$parent.$id}}_ldapCloseTest" data-ng-click="closeTest()" class="bx--btn--secondary bx--btn--sm" type="button" data-ng-disabled="performingTest">{{::'close' | translate}}</button>
            <button data-ng-click="performTest()" class="bx--btn bx--btn--sm" type="button" data-ng-disabled="ldapForm.$invalid || !testDetails.testUsername || !testDetails.testPassword || performingTest">{{::'testConnectionLabel' | translate}}</button>
            <div class="loadingAnimate apiHidden" data-ng-class="{apiHidden: !performingTest}"></div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
