<!--
/********************************************************* {COPYRIGHT-TOP} ***
* Licensed Materials - Property of IBM
* 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
*
* (C) Copyright IBM Corporation 2017
*
* All Rights Reserved.
* US Government Users Restricted Rights - Use, duplication or disclosure
* restricted by GSA ADP Schedule Contract with IBM Corp.
********************************************************** {COPYRIGHT-END} **/
-->
<div data-ng-controller="CommunityDeveloperOrganizationsController">

  <div data-ng-include="'apim/community/partials/community-header.html'"></div>
  <div class="secondaryBackground centerColumn">
    <div class="floatRight">
      <pagination style="margin: 0px;" data-ng-show="!loadingDeveloperOrgs && totalItems > pageSize" boundary-links="true" rotate="false" data-ng-change="developerOrgsPageChanged(currentPage)" total-items="totalItems" data-ng-model="currentPage" class="pagination-sm" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" items-per-page="pageSize" max-size="3"></pagination>
    </div>
    <div class="clearBoth"></div>
    <div class="bx--responsive-table-container">
      <table class="bx--responsive-table">
        <thead class="bx--table-head">
          <tr class="bx--table-row">

            <th class="bx--table-header bx--table-sort bxTablePaddingLeft" ng-class="{'bx--table-sort--ascending' : orderDirection, 'bx--table-sort-active' : orderProp == 'displayName'}" data-event="sort" data-ng-click="orderProp = 'displayName'; orderDirection = !orderDirection;">
                <bx-checkbox aria-label="{{currentPageDeveloperOrgs.displayName}}" data-ng-model="selectAllOrgs" data-ng-model-options="{getterSetter:true, debounce:100}">
                </bx-checkbox>
            </th>

            <th class="bx--table-header bx--table-sort" ng-class="{'bx--table-sort--ascending' : orderDirection, 'bx--table-sort-active' : orderProp == 'displayName'}" data-event="sort" data-ng-click="orderProp = 'displayName'; orderDirection = !orderDirection;">
              <span>{{::'community-developer-organization' | translate}}</span>
              <bx-icon class="bx--table-sort__svg" icon="caret--down"></bx-icon>
            </th>

            <th class="bx--table-header">
              {{::'communities' | translate}}
            </th>

            <th class="bx--table-header bx--table-sort" ng-class="{'bx--table-sort--ascending' : orderDirection, 'bx--table-sort-active' : orderProp == '$$ownerName'}" data-ng-click="orderProp = '$$ownerName'; orderDirection = !orderDirection;">
              <span>{{::'owner' | translate}}</span>
              <bx-icon class="bx--table-sort__svg" icon="caret--down"></bx-icon>
            </th>

            <th class="bx--table-header bx--table-sort" ng-class="{'bx--table-sort--ascending' : orderDirection, 'bx--table-sort-active' : orderProp == '$$status'}" data-ng-click="orderProp = '$$status'; orderDirection = !orderDirection;">
            <span>{{::'status' | translate}}</span>
              <bx-icon class="bx--table-sort__svg" icon="caret--down"></bx-icon>
            </th>

            <th class="bx--table-header bxTablePaddingRight">
              <button class="mediumButton iconOnlyButton" role="button" title="{{::'sendAll' | translate}}"
                data-ng-disabled="selectedOrgs.length == 0" data-ng-click="sendMessage(selectedOrgs)">
                <div class="material-icons" style="margin-top: -2px;" aria-label="{{::'sendAll' | translate}}">message</div>
              </button>
            </th>
          </tr>
        </thead>
        <tbody class="bx--table-body">
          <tr class="bx--table-row bx--parent-row" data-ng-show="loadingDeveloperOrgs">
            <td colspan="6"><div class="spinner"></div></td>
          </tr>

          <tr class="bx--table-row bx--parent-row" data-ng-show="developerOrgs && developerOrgs.length === 0 && !loadingDeveloperOrgs">
            <td colspan="5" class="table-empty">{{(spaceId ? 'community-no-developer-orgs-space' : 'community-no-developer-orgs') | translate}}</td>
          </tr>

          <tr class="bx--table-row bx--parent-row" data-ng-show="developerOrgs && developerOrgs.length > 0 && filteredDeveloperOrgs.length === 0 && !loadingDeveloperOrgs">
            <td colspan="5">{{::'community-no-matching-developer-orgs' | translate}}</td>
          </tr>

          <tr class="bx--table-row bx--parent-row" data-ng-show="!loadingDeveloperOrgs" ng-class-even="'bx--parent-row--even'" data-ng-repeat="developerOrg in filteredDeveloperOrgs = (filterDeveloperOrgs(query) | orderBy: orderProp: orderDirection)" data-ng-controller="CommunityDeveloperOrganizationController">

            <td class="bxTablePaddingLeft">
                <bx-checkbox aria-label="{{developerOrg.displayName}}" data-ng-model="developerOrg.selected" data-ng-model-options="{getterSetter:true, debounce:100}">
                </bx-checkbox>
            </td>

            <td>
              <span data-ng-bind-html="developerOrg.displayName | highlight: query"></span>
              <button style="margin-top: -2px;" class="material-icons iconOnlyButton alignMiddle infoIcon" data-ng-click="showTooltip = !showTooltip;" data-tooltip-is-open="showTooltip" data-tooltip-html-unsafe="{{developerOrg.name | highlight: query}}" data-tooltip-placement="right">info_outline</button>
            </td>

            <td class="simpleList tagContainer displayInline">
              <div role="listitem" class="displayInline" data-ng-repeat="tag in orgTags">
                <div class="tag communityTag {{tag.className}}" value="{{::tag.value}}" title="{{::tag.label}}">
                  <div class="tagLabel" data-ng-bind-html="tag.label | highlight: query"></div>
                  <button class="iconOnlyButton material-icons" data-ng-click="deleteTag(tag);" title="{{'ttDelete' | translate}}" data-ng-show="permissions[spaceId ? spaceId + '/space_developers/manage' : environment.id + '/catalog_developers/manage']">close</button>
                </div>
              </div>
              <div role="listitem" class="displayInline" data-ng-show="permissions[spaceId ? spaceId + '/space_developers/manage' : environment.id + '/catalog_developers/manage']">
                <div role="listitem" class="displayInline dropdown orgTagButton" dropdown data-is-open="tagDropdownOpen">
                  <button class="mediumButton iconOnlyButton dropdown-toggle" role="button" dropdown-toggle title="{{::'assignCommunity' | translate}}">
                    <div class="material-icons" style="margin-top: -2px;" aria-label="{{::'assignCommunity' | translate}}">add_circle_outline</div>
                  </button>
                  <ul class="dropdown-menu simpleList tagContainer tagDropdown" aria-label="{{::'addTaglabel' | translate}}" role="menu" data-ng-if="tagDropdownOpen" onkeypress="tagDropdownOpen = true;">
                    <li role="menuitem" class="clickable" data-ng-keypress="assignTag(tag);" data-ng-click="assignTag(tag);" data-ng-repeat="tag in tags | notInArrayByField: orgTags: 'value' | excludeUntagged">
                      <apim-tag></apim-tag>
                    </li>
                    <li role="menuitem" data-ng-click="$event.stopPropagation();" title="{{::'createNewCommunityPlaceholder' | translate}}">
                      <input data-ng-keypress="createTag($event);" title="{{::'createNewCommunityPlaceholder' | translate}}" placeholder="{{::'createNewCommunityPlaceholder' | translate}}" style="padding: 5px; width: 148px; margin-top: 3px;" data-ng-model="$parent.newTag" maxlength="100" required>
                    </li>
                  </ul>
                </div>
              </div>

            </td>
            <td data-ng-bind-html="developerOrg.$$ownerName | highlight: query"></td>
            <td data-ng-bind-html="developerOrg.$$status | highlight: query"></td>
            <td class="bx--table-overflow fixed-overflow bxTablePaddingRight">
              <div class="dropdown actionMenu" dropdown data-is-open="menuOpen" data-ng-show="permissions[spaceId ? spaceId + '/space_developers/manage' : environment.id + '/catalog_developers/manage']">
                <bx-overflow-menu>
                  <bx-overflow-menu-item item-text="{{::'community-devorg-edit' | translate}}" data-ng-click="editDeveloperOrg($event);">
                  </bx-overflow-menu-item>

                  <bx-overflow-menu-item item-text="{{::'resendInviteOwner' | translate}}" data-ng-show="developerOrg.status === 'pending'" data-ng-click="resendInvite();">
                  </bx-overflow-menu-item>

                  <bx-overflow-menu-item item-text="{{::'changeOrgOwner' | translate}}"  data-ng-click="changeOwner();">
                  </bx-overflow-menu-item>

                  <bx-overflow-menu-item item-text="{{::'messageSend' | translate}}" data-ng-click="sendMessage(developerOrg);">
                  </bx-overflow-menu-item>

                  <bx-overflow-menu-item item-text="{{::'community-show-applications' | translate}}" data-ng-click="openView(3, developerOrg.displayName)">
                  </bx-overflow-menu-item>

                  <bx-overflow-menu-item item-text="{{::'community-show-subscriptions' | translate}}" data-ng-click="openView(4, developerOrg.displayName)">
                  </bx-overflow-menu-item>

                  <bx-overflow-menu-item item-text="{{::'community-devorg-delete' | translate}}" data-ng-click="deleteDeveloper();" warn-user="true">
                  </bx-overflow-menu-item>

                </bx-overflow-menu>

              </div>

            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
