<!--
/********************************************************* {COPYRIGHT-TOP} ***
* Licensed Materials - Property of IBM
* 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
*
* (C) Copyright IBM Corporation 2017
*
* All Rights Reserved.
* US Government Users Restricted Rights - Use, duplication or disclosure
* restricted by GSA ADP Schedule Contract with IBM Corp.
********************************************************** {COPYRIGHT-END} **/
-->
<h2 class="bx--modal-content__heading" id="{{$id}}_bannerHeading">{{::'community-subscription-create' | translate}}</h2>
<button title="Close" class="bx--modal__close" type="button" data-ng-click="cancel();" tabindex="-1">
  <bx-icon class="bx--modal__close--icon" icon="close"></bx-icon>
</button>
<div class="bx--modal-content community webapi" data-ng-switch="currentPage">
  <div data-ng-switch-default>
    <div style="margin-bottom: 15px;">{{'community-create-subscription-desc' | translate}}</div>
    <div style="margin-bottom: 15px;">{{'community-subscription-select-application' | translate}}</div>
    <div class="bx--form__row-item">
      <div class="bx--search bx--search--sm" role="search">
        <label for="search__input" class="bx--search__label">Search</label>
        <input type="search" class="bx--search__input" id="search__input" ng-model="appQuery" type="text" spellcheck="false" title="{{'find' | translate}}" placeholder="{{'find' | translate}}">
      </div>
    </div>
    <div class="primaryBorder bx--form__row-item">
      <div class="tableHeaderBackground bxTableHeader" style="border-top: none;">
        <div class="column new-subscription-application-column-title">{{'application' | translate}}</div><div
        class="column new-subscription-developer-org-column">{{'orgName' | translate}}</div>
      </div>
      <div data-ng-show="loadingApps">
        <div class="spinner"></div>
      </div>
      <ul class="simpleList boundedList" data-ng-show="!loadingApps">
        <li class="application-select" data-ng-click="selectApplication(application);" data-ng-class="{'selected': selectedApplication === application}" data-ng-repeat="application in applications | communityActiveInCurrentOrg: currentOrg | filter: appQuery" ng-class-even="'bxTableRowEven'" ng-class-odd="'bxTableRowOdd'">
          <div class="displayInline new-subscription-application-column" data-ng-bind-html="application.appName"></div>
          <div class="displayInline new-subscription-developer-org-column" data-ng-bind-html="application.$$developerOrgName"></div>
        </li>
      </ul>
    </div>
  </div>
  <div data-ng-switch-when="2">
    <div style="margin-bottom: 15px;">{{'community-subscription-select-plan' | translate}}</div>
    <div class="bx--form__row-item">
      <div class="bx--search bx--search--sm" role="search">
        <input type="search" class="bx--search__input" data-ng-model="planVersionQuery" spellcheck="false" title="{{'find' | translate}}" placeholder="{{'find' | translate}}">
      </div>
    </div>
    <div class="primaryBorder bx--form__row-item">
      <div class="tableHeaderBackground minimalPlanVersion" style="border-top: none;">
        <div class="column manageProductPlanNameColumn">{{'plansPlural' | translate}}</div>
      </div>
      <div data-ng-if="loadingProducts">
        <div class="spinner"></div>
      </div>
      <ul class="simpleList boundedList productVersions" data-ng-if="!loadingProducts">
        <li data-ng-repeat="otherProductVersion in filteredProductVersions = (products | communityNotAlreadySubscribed: subscriptions: selectedApplication | deploymentNameOnlyQuery: planVersionQuery)" ng-class-even="'bxTableRowEven'" ng-class-odd="'bxTableRowOdd'">
          <div class="tableHeaderBackground minimalPlanVersion" style="font-size: medium;">
            {{otherProductVersion.document.info.title}}&nbsp;&nbsp;{{otherProductVersion.productVersion}}
          </div>
          <ul class="planVersions">
            <li data-ng-repeat="planVersion in otherProductVersion.dependents.PLANVERSION">
              <apim-deployed-product-plan data-ng-click="planVersionSelected(planVersion.planName, otherProductVersion)" class="minimalPlanVersion"></apim-deployed-product-plan>
            </li>
          </ul>
        </li>
      </ul>
      <div class="mediumPadding" data-ng-if="!loadingProducts && filteredProductVersions.length == 0">{{productVersions | deploymentProductReplaceNoDescriptors: planVersionQuery}}</div>
    </div>
  </div>
</div>
<!-- footer -->
<div class="bx--modal__buttons" role="contentinfo" aria-label="{{'footerSectionLabel' | translate}}">
  <div class="bx--modal__buttons-container floatLeft">
    <button class="bx--btn--secondary floatLeft no-animate" type="button" data-ng-show="currentPage > 1" data-ng-click="currentPage = 1">{{'back' | translate}}</button>
  </div>
  <div class="bx--modal__buttons-container">
    <button class="bx--btn--secondary" type="button"  data-ng-click="cancel()">{{'cancel' | translate}}</button>
    <button class="bx--btn no-animate" type="button"  data-ng-show="currentPage < pageCount" data-ng-disabled="!selectedApplication" data-ng-click="currentPage = 2">{{'next' | translate}}</button>
    <button class="bx--btn no-animate" type="button"  data-ng-show="currentPage == 2" data-ng-disabled="!selectedPlanName || !selectedProductVersion" data-ng-click="done()">{{'done' | translate}}</button>
  </div>
</div>
