<!--
/********************************************************* {COPYRIGHT-TOP} ***
* Licensed Materials - Property of IBM
* 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
*
* (C) Copyright IBM Corporation 2017
*
* All Rights Reserved.
* US Government Users Restricted Rights - Use, duplication or disclosure
* restricted by GSA ADP Schedule Contract with IBM Corp.
********************************************************** {COPYRIGHT-END} **/
-->
<div data-ng-controller="CommunityApplicationsController">

  <div data-ng-include="'apim/community/partials/community-header.html'"></div>
  <div class="secondaryBackground centerColumn">
    <div class="floatRight">
      <pagination style="margin: 0px;" data-ng-show="!loadingApps && totalItems > pageSize" boundary-links="true" rotate="false" data-ng-change="appsPageChanged(currentPage)" total-items="totalItems" data-ng-model="currentPage" class="pagination-sm" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" items-per-page="pageSize" max-size="3"></pagination>
    </div>
    <div class="clearBoth"></div>
    <div class="bx--responsive-table-container">
      <table class="bx--responsive-table">
        <thead class="bx--table-head">
          <tr class="bx--table-row">

            <th class="bx--table-header bx--table-sort bxTablePaddingLeft" ng-class="{'bx--table-sort--ascending' : orderDirection, 'bx--table-sort-active' : orderProp == 'appName'}" data-ng-click="orderProp = 'appName'; orderDirection = !orderDirection;">
              <span>{{::'application' | translate}}</span>
              <bx-icon class="bx--table-sort__svg" icon="caret--down"></bx-icon>
            </th>

            <th class="bx--table-header bx--table-sort bxTablePaddingLeft"
              ng-show="environment.applicationLifecycleEnabled"
              ng-class="{'bx--table-sort--ascending' : orderDirection, 'bx--table-sort-active' : orderProp == 'type'}"
              data-ng-click="orderProp = 'type'; orderDirection = !orderDirection;">
              <span>{{::'type' | translate}}</span>
              <bx-icon class="bx--table-sort__svg" icon="caret--down"></bx-icon>
            </th>

            <th class="bx--table-header bx--table-sort" ng-class="{'bx--table-sort--ascending' : orderDirection, 'bx--table-sort-active' : orderProp == 'clientId'}" data-ng-click="orderProp = 'clientId'; orderDirection = !orderDirection;">
              <span>{{::'clientId' | translate}}</span>
              <bx-icon class="bx--table-sort__svg" icon="caret--down"></bx-icon>
            </th>

            <th class="bx--table-header bx--table-sort" ng-class="{'bx--table-sort--ascending' : orderDirection, 'bx--table-sort-active' : orderProp == '$$developerOrgName'}" data-ng-click="orderProp = '$$developerOrgName'; orderDirection = !orderDirection;">
              <span>{{::'organization' | translate}}</span>
              <bx-icon class="bx--table-sort__svg" icon="caret--down"></bx-icon>
            </th>

            <th class="bx--table-header bx--table-sort" ng-class="{'bx--table-sort--ascending' : orderDirection, 'bx--table-sort-active' : orderProp == 'state'}" data-ng-click="orderProp = 'state'; orderDirection = !orderDirection;">
              <span>{{::'status' | translate}}</span>
              <bx-icon class="bx--table-sort__svg" icon="caret--down"></bx-icon>
            </th>

            <th class="bx--table-header bxTablePaddingRight"></th>
          </tr>
        </thead>
        <tbody class="bx--table-body">
          <tr class="bx--table-row bx--parent-row bxTablePaddingLeft" data-ng-show="loadingApps">
            <td colspan="6"><div class="spinner"></div></td>
          </tr>
          <tr class="bx--table-row bx--parent-row bxTablePaddingLeft" data-ng-show="consumerApps && consumerApps.length === 0 && !loadingApps">
            <td colspan="5" class="table-empty">{{(spaceId ? 'community-no-applications-space' : 'community-no-applications') | translate}}</td>
          </tr>

          <tr class="bx--table-row bx--parent-row bxTablePaddingLeft" data-ng-show="consumerApps && consumerApps.length > 0 && filteredApplications.length === 0 && !loadingApps">
            <td colspan="5">{{::'community-no-matching-applications' | translate}}</td>
          </tr>

          <tr class="bx--table-row bx--parent-row" data-ng-show="!loadingApps" ng-class-even="'bx--parent-row--even'"
          data-ng-repeat="application in filteredApplications = (filterApps(query) | orderBy: orderProp: orderDirection)" data-ng-controller="CommunityApplicationController">

            <td class="bxTablePaddingLeft" data-ng-bind-html="application.appName | highlight: query"></td>
            <td ng-show="environment.applicationLifecycleEnabled">
              <span class="tag--beta appLifecycleTag appLifecycle-development"
                ng-if="application.type == 'DEVELOPMENT'">
                {{::'development_applications' | translate}}
              </span>
              <span class="tag--beta appLifecycleTag"
                ng-if="application.type != 'DEVELOPMENT'">
                {{::'production_applications' | translate}}
              </span>
            </td>
            <td data-ng-bind-html="application.clientId | highlight: query"></td>
            <td data-ng-bind-html="application.$$developerOrgName | highlight: query"></td>
            <td data-ng-bind-html="application.state.toLowerCase() | translate | highlight: query"></td>
            <td class="bx--table-overflow bxTablePaddingRight">
              <div class="dropdown actionMenu" dropdown data-is-open="menuOpen" data-ng-show="permissions[spaceId ? spaceId + '/space_applications/manage' : environment.id + '/catalog_applications/manage']">
                <div class="absolute_overflow">
                  <bx-overflow-menu>

                    <bx-overflow-menu-item item-text="{{::'subscriptionsSubscribeApp' | translate}}" data-ng-if="application.$$developerOrg.id == orgId && application.state.toLowerCase() !== 'suspended'" data-ng-click="subscribeApp();">
                    </bx-overflow-menu-item>

                    <bx-overflow-menu-item item-text="{{::'subscriptionsSuspendApp' | translate}}" data-ng-show="application.state.toLowerCase() !== 'suspended'" data-ng-click="suspendApp();">
                    </bx-overflow-menu-item>

                    <bx-overflow-menu-item item-text="{{::'subscriptionsResumeApp' | translate}}" data-ng-show="application.state.toLowerCase() === 'suspended'" data-ng-click="resumeApp();">
                    </bx-overflow-menu-item>

                    <bx-overflow-menu-item item-text="{{::'community-show-developer-org' | translate}}" data-ng-click="openView(1, application.$$developerOrgName)">
                    </bx-overflow-menu-item>

                    <bx-overflow-menu-item item-text="{{::'community-show-subscriptions' | translate}}" data-ng-click="openView(4, application.clientId)">
                    </bx-overflow-menu-item>

                    <bx-overflow-menu-item item-text="{{::'subscriptionsDeleteApp' | translate}}" data-ng-if="application.$$developerOrg.id == orgId" data-ng-click="deleteApp();" warn-user="true">
                    </bx-overflow-menu-item>

                  </bx-overflow-menu>
                </div>

              </div>

            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
