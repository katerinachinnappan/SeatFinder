/********************************************************* {COPYRIGHT-TOP} ***
 * Licensed Materials - Property of IBM
 * 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
 *
 * (C) Copyright IBM Corporation 2017
 *
 * All Rights Reserved.
 * US Government Users Restricted Rights - Use, duplication or disclosure
 * restricted by GSA ADP Schedule Contract with IBM Corp.
 ********************************************************** {COPYRIGHT-END} **/
// Node module: apim-ui

'use strict';

angular.module('bluemix.components')
  .directive('bxCheckbox', function() {
    return {
      restrict: 'E',
      transclude: true,
      templateUrl: 'apim/bluemix/components/checkbox/checkbox.html',
      scope: {
        ngModel: '=?',
        ngModelOptions: '=?',
        ngClick: '&?',
        ngDisabled: '=?',
        ngChecked: '=?',
        bxPreventDefault: '=?',
      },
      controller: function($scope) {
        $scope.ngModelOptions= $scope.ngModelOptions || {};
      },
      link: function(scope, element, attr) {
        if (scope.ngModel) {
          scope.ngChecked = (scope.ngModelOptions.getterSetter && scope.ngChecked === undefined) ? scope.ngModel() : scope.ngModel;
        }
        if (scope.bxPreventDefault) {
          // when checkbox is in  a context such as an overflow menu,
            // spacebar would trigger both the toggle open-close of menu, and the checkbox
          // for accessibilty means user would lose context
          element.bind('keydown', function(event) {
            if (event.keyCode == 32 || event.keyCode == 13) {
              event.preventDefault();
              scope.ngModel = !scope.ngModel;
              scope.$apply();
            }
          });
        }
      },
    };
  });

