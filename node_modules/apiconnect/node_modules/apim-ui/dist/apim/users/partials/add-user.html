<!--
/********************************************************* {COPYRIGHT-TOP} ***
* Licensed Materials - Property of IBM
* 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
*
* (C) Copyright IBM Corporation 2017
*
* All Rights Reserved.
* US Government Users Restricted Rights - Use, duplication or disclosure
* restricted by GSA ADP Schedule Contract with IBM Corp.
********************************************************** {COPYRIGHT-END} **/
-->
<div data-ng-controller="AddUserController as addUserController">
	<nav data-ng-show="provider == 'apim' || provider == 'scim'" class="subBanner" role="navigation" aria-label="{{::'userOptions' | translate}}">
		<ul class="menuList">
			<li data-ng-click="$parent.tab = 1" data-ng-class="{selected: $parent.tab == 1}" tabindex="-1">
				<a href="javascript: void(0);" title="{{::'existingUser' | translate}}" data-ng-click="$parent.tab = 1">{{::'existingUser' | translate}}</a>
			</li><li data-ng-click="$parent.tab = 2" data-ng-class="{selected: $parent.tab == 2}" tabindex="-1">
				<a href="javascript: void(0);" title="{{::'newUser' | translate}}" data-ng-click="$parent.tab = 2">{{::'newUser' | translate}}</a>
			</li>
		</ul>
	</nav>
	<section data-ng-show="(provider == 'apim' || provider == 'scim') && $parent.tab == 1" data-ng-init="$parent.tab = 1">
    <div role="search" class="displayInline itsAllRelative searchBanner flex fullWidth bx--search">
      <label for="search__input" class="bx--search__label">Search</label>
      <input type="search" class="bx--search__input" id="search__input" placeholder="{{::'usersSearch' | translate}}" data-ng-model="$parent.searchString " data-ng-pattern="/[a-zA-Z0-9._@\s' \/%+\-]*/" apim-auto-focus title="{{::'usersSearch' | translate}}">   
      <button class="iconOnlyButton" data-ng-click="searchUsers()" title="{{::'usersSearch' | translate}}"><svg class="search-user-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#bx-src-icons--search"></use></svg></button>
    </div>
		<div class="topMargin">{{::'searchResults' | translate}}</div>
		<div class="searchResults">
			<div>
				<div data-ng-show="searchResults.length > 0" data-ng-repeat="user in searchResults" class="userNode" data-ng-click="$parent.$parent.selectedUser = user" data-ng-class="{selected: $parent.$parent.selectedUser == user}">
					{{renderUserName(user)}}
					<span data-ng-if="user.email">{{user.email}}</span>
					<span data-ng-if="!user.email" class="noEmail">{{::'noEmail' | translate}}</span>
				</div>
				<div data-ng-show="searchResults.length < 1" class="userNode">{{::'noResults' | translate}}</div>
			</div>
			<div class="loadingAnimation38" data-ng-show="searchingForUsers"></div>
		</div>
	</section>
	<section data-ng-show="$parent.tab == 2 || provider == 'authUrl' || provider == 'portal' " class="layout topMargin">
    <bx-input-container>
      <label class="bx--form__label">{{::'enterEmail' | translate}}</label>
      <input class="bx--text__input" type="text" placeholder="{{::'enterEmail' | translate}}" data-ng-model="userData.email" spellcheck="false" data-ng-pattern="/[a-zA-Z0-9._ \/%+\-]+@[a-zA-Z0-9.\-]+/" data-ng-maxlength="255" data-ng-required="tab == 2 || provider == 'authUrl'" />
    </bx-input-container>
	</section>
	<section data-ng-show="provider == 'ldap'">
    <div role="search" class="displayInline itsAllRelative searchBanner flex fullWidth bx--search">
      <label>{{::'usersSearch' | translate}}</label>
      <input type="search" class="bx--text__input" data-ng-if="$parent.takeFocus" data-ng-model="$parent.searchString" data-ng-pattern="/[a-zA-Z0-9._@\s' \/%+\-]*/" apim-auto-focus title="{{::'usersSearch' | translate}}" placeholder="{{::'usersSearch' | translate}}" />
      <input type="search" class="bx--text__input" data-ng-if="!$parent.takeFocus" data-ng-model="$parent.searchString" data-ng-pattern="/[a-zA-Z0-9._@\s' \/%+\-]*/" title="{{::'usersSearch' | translate}}" placeholder="{{::'usersSearch' | translate}}" />
      <button class="iconOnlyButton" data-ng-click="searchUsers()" title="{{::'usersSearch' | translate}}"><svg class="search-user-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#bx-src-icons--search"></use></svg></button>
    </div>
		<div class="topMargin">{{::'searchResults' | translate}}</div>
		<div class="searchResults">
			<div>
				<div data-ng-show="searchResults.length > 0" data-ng-repeat="user in searchResults" class="userNode" data-ng-click="$parent.$parent.selectedUser = user" data-ng-class="{selected: $parent.$parent.selectedUser == user}">
					{{renderUserName(user)}}
					<span data-ng-if="user.email">{{user.email}}</span>
					<span data-ng-if="!user.email" class="noEmail">{{::'noEmail' | translate}}</span>
				</div>
				<div data-ng-show="searchResults.length < 1" class="userNode">{{::'noResults' | translate}}</div>
				<div data-ng-show="searchError" class="userNode">{{searchError}}</div>
			</div>
			<div class="loadingAnimation38" data-ng-show="searchingForUsers"></div>
		</div>
	</section>
	<section data-ng-show="provider == 'saml' || provider == 'openid'" class="layout">
		<bx-input-container class="flex-100">
			<label class="mandatory">{{::'enterIbmid' | translate}}</label>
			<input type="text" data-ng-model="userData.email" spellcheck="false" data-ng-pattern="/[a-zA-Z0-9._ \/%+\-]+@[a-zA-Z0-9.\-]+/" data-ng-maxlength="255" data-ng-required="provider == 'saml' || provider == 'openid'" />
		</bx-input-container>
	</section>
	<section class="topMargin roleSection" data-ng-show="!addOwner">
	  <h3>{{::'assignRole' | translate}}</h3>
	  <div class="horizontalScroll">
	    <div class="tableHeaderBackground apiSelfClear" data-ng-attr-style="width: {{150 * filteredRoles.length}}px">
	      <div class="roleBox"><div data-ng-repeat="role in filteredRoles = (roleList | notOwnerRole)" class="column oneRoleColumn">{{role.displayName}}</div></div>
	    </div>
	    <ul class="userList">
	      <li>
	        <div class="roleBox">
	          <div data-ng-repeat="role in roleList | notOwnerRole" class="column oneRoleColumn horizontalScrollPadBottom">
	          	<bx-checkbox class="centeredBoxout compactSize itsAllRelative" data-ng-checked="isInRole(role)" data-ng-click="toggleRole(role)" aria-label="{{::'apiAddRoleSpecific' | translate:role}}" title="{{::'apiAddRoleSpecific' | translate:role}}">
	          	</bx-checkbox>
	          </div>
	        </div>
	      </li>
	    </ul>
	  </div>
	</section>
</div>
