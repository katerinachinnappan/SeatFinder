<!--
/********************************************************* {COPYRIGHT-TOP} ***
* Licensed Materials - Property of IBM
* 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
*
* (C) Copyright IBM Corporation 2017
*
* All Rights Reserved.
* US Government Users Restricted Rights - Use, duplication or disclosure
* restricted by GSA ADP Schedule Contract with IBM Corp.
********************************************************** {COPYRIGHT-END} **/
-->
<div class="card primaryBorder apiSelfClear" data-ng-class="{backgroundDisabled: beingDeleted}" data-ng-controller="UserController as userController">
  <div class="rowPadding">
	  <div class="column nameColumn">
      <div><span class="userDisplayName" title="{{::user.user | userDisplayName}}" data-ng-bind-html="::user.user | userDisplayName | highlight: query"></span> <span class="lozenge orgOwnerColour" data-ng-if="::isInRole({name: 'owner'})">{{::'apiOrgOwnerRole' | translate}}</span> <span class="lozenge catalogOwnerColour" data-ng-if="::isInRole({name: 'catalogowner'})">{{::'apiCatalogOwnerRole' | translate}}</span> <span class="lozenge spaceOwnerColour" data-ng-if="::isInRole({name: 'spaceowner'})">{{::'apiSpaceOwnerRole' | translate}}</span></div>
      <div class="boundedText secondaryText" title="{{::user.user.email}}" data-ng-bind-html="::user.user.email | highlight: query"></div>
	  </div><div class="column locationColumn" data-ng-if="usersScope != 'space'">
	    <div class="boundedText">{{::user | locationForUser: this: usersScope}}</div>
	    <button class="iconOnlyButton material-icons" data-ng-class="{'rotate180': $parent.$parent.expanded}" data-ng-if="user.childMembership.length > 0" data-ng-click="$parent.$parent.expanded = !$parent.$parent.expanded">keyboard_arrow_down</button>
	    <div data-ng-if="user.childMembership.length > 0" class="twistieBox" data-ng-show="$parent.$parent.expanded">
	      <ul>
	        <li class="childBox" data-ng-repeat="childMember in user.childMembership"><span class="boundedText">{{childMember | catalogNameFromChild: this}}</span> <span data-ng-if="::isInChildRole(childMember, {name: 'catalogowner'})" title="{{::'apiCatalogOwnerRole' | translate}}" class="material-icons">account_circle</span> <span data-ng-if="::isInChildRole(childMember, {name: 'spaceowner'})" title="{{::'apiSpaceOwnerRole' | translate}}" class="material-icons">account_circle</span>
	          <ul data-ng-if="childMember.childMembership">
	            <li class="childBox" data-ng-repeat="subchildMember in childMember.childMembership"><span class="boundedText">{{subchildMember | catalogNameFromChild: this}}</span> <span data-ng-if="::isInChildRole(subchildMember, {name: 'spaceowner'})" title="{{::'apiSpaceOwnerRole' | translate}}" class="material-icons">account_circle</span></li>
	          </ul>
	        </li>
	      </ul>
	    </div>
	  </div><div class="column roleColumn">
			<div data-ng-if="::canViewRoles" class="roleBox fixOverlap">
				<div class="roleColumnScroll" data-ng-class="{'twisted': expanded}">
				  <div data-ng-repeat="role in ::roles | notOwnerRole" class="column oneRoleColumn">
						<div class="compactSize">
							<label class="bx--checkbox__label">
								<input class="bx--checkbox bx--checkbox--svg" type="checkbox" data-ng-model="$userRole" data-ng-model-options="{getterSetter: true}" data-ng-disabled="::isDisabled(role)" aria-label="{{::roleMessages[role.id]}}" title="{{::roleMessages[role.id]}}">
								<span class="bx--checkbox__appearance">
									<bx-icon class="bx--checkbox__checkmark" icon="checkmark"></bx-icon>
								</span>
							</label>
						</div>
					</div>
		      <div data-ng-if="user.childMembership.length > 0" class="twistieBox" data-ng-show="$parent.expanded">
		        <ul>
		          <li data-ng-repeat="childMember in user.childMembership">
		            <div data-ng-repeat="role in ::roles | notOwnerRole" class="column oneRoleColumn">
									<div class="compactSize">
										<label class="bx--checkbox__label">
											<input class="bx--checkbox bx--checkbox--svg" type="checkbox" data-ng-model="$userRole" data-ng-model-options="{getterSetter: true}" data-ng-disabled="true" aria-label="{{::roleMessages[role.id]}}" title="{{::roleMessages[role.id]}}">
											<span class="bx--checkbox__appearance">
												<bx-icon class="bx--checkbox__checkmark" icon="checkmark"></bx-icon>
											</span>
										</label>
									</div>
								</div>
		            <ul data-ng-if="childMember.childMembership">
		              <li data-ng-repeat="subchildMember in childMember.childMembership">
		                <div data-ng-repeat="role in ::roles | notOwnerRole" class="column oneRoleColumn">
											<div class="compactSize">
												<label class="bx--checkbox__label">
													<input class="bx--checkbox bx--checkbox--svg" type="checkbox" data-ng-model="$userRole" data-ng-model-options="{getterSetter: true}" data-ng-disabled="true" aria-label="{{::roleMessages[role.id]}}" title="{{::roleMessages[role.id]}}">
													<span class="bx--checkbox__appearance">
														<bx-icon class="bx--checkbox__checkmark" icon="checkmark"></bx-icon>
													</span>
												</label>
											</div>
										</div>
		              </li>
		            </ul>
		          </li>
		        </ul>
		      </div>
				</div>
			</div>
			<div data-ng-if="::!canViewRoles">
			   <ul>
			     <li class="roleTag" data-ng-repeat="userRole in user.roles">{{userRole.displayName}}</li>
			   </ul>
			</div>
	  </div><div class="column statusColumn bxStatusColumn">
	    <div>{{::user.user | lastLoginForUser}}</div>
	    <a href="" class="secondaryText" data-ng-show="::user.user.status == 'pending' && canEdit" data-ng-click="resendInvite(user.user)">{{::'resendInvite' | translate}}</a>
	  </div><div class="column" data-ng-show="canEdit">
	    <button class="iconOnlyButton" data-ng-disabled="user.roles.length == 0 || beingDeleted || isInAnyOfRoles(['owner', 'catalogowner', 'cloudowner']) || (!hasModifiableRoles() && usersScope != 'org')" title="{{::'ttDelete' | translate}}" data-ng-click="remove()"><div class="material-icons">delete</div></button>
	  </div>
  </div>
</div>
