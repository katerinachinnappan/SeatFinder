<!--
/********************************************************* {COPYRIGHT-TOP} ***
* Licensed Materials - Property of IBM
* 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
*
* (C) Copyright IBM Corporation 2017
*
* All Rights Reserved.
* US Government Users Restricted Rights - Use, duplication or disclosure
* restricted by GSA ADP Schedule Contract with IBM Corp.
********************************************************** {COPYRIGHT-END} **/
-->
<div class="spinnerOverlay" data-ng-if="modifyingObject">
  <div class="spinner"></div>
</div>
<h2 class="bx--modal-content__heading">{{::dialogTitle | translate}}</h2>
<button class="bx--modal__close" type="button" data-modal-close data-ng-click="cancel()">
  <bx-icon class="bx--modal__close--icon" icon="close"></bx-icon>
</button>
<div class="bx--modal-content">
    <form name="OauthForm" class="bx--form">
      <bx-input-container>
        <label>{{::'title' | translate}}</label>
        <input data-ng-model="selectedOauth.title" required/>
      </bx-input-container>
      <bx-input-container>
        <label>{{::'name' | translate}}</label>
        <input data-ng-model="selectedOauth.name" required/>
      </bx-input-container>
      <bx-input-container>
        <label>{{::'api_base_path' | translate}}</label>
        <input data-ng-model="selectedOauth.basePath" required/>
      </bx-input-container>
      <bx-input-container>
        <label>{{::'description' | translate}}</label>
        <textarea class="bx--textarea__limit bx--textarea__input" data-ng-model="selectedOauth.description"></textarea>
      </bx-input-container>
      <section class="certificatesList sectionTopBorder" data-ng-if="!hideCertDetails">
        <div class="bx--form__legend">
          {{::'objects-oauth-provider-type' | translate}}
        </div>
        <div class="bx--select labeledSelect">
          <label for="api-oauth-provider-type" class="bx--form__label">{{::'objects-oauth-provider-type' | translate}}</label>
          <select class="bx--select__input" id="api-oauth-provider-type" required data-ng-model="selectedOauth['provider-type']" data-ng-model-options="{debounce:500}">
            <option class="bx--select__option" value="apiconnect">
              {{::'objects-oauth-apiconnect' | translate}}
            </option>
            <option class="bx--select__option" value="external" disabled>
              {{::'objects-oauth-external' | translate}}
            </option>
          </select>
          <bx-icon class="bx--select__arrow" icon="caret--down"></bx-icon>
        </div>
        <button title="{{::'api_oauth_scopes_add' | translate}}" aria-label="{{::'api_oauth_scopes_add' | translate}}" class="iconOnlyButton material-icons addScopeButton" data-ng-click="createScope()">add_circle_outline</button>
        <div class="bx--form__legend">
          {{::'api_oauth_scopes' | translate}}
        </div>
          <div data-ng-repeat="(oauthScopeName, oauthScope) in selectedOauth.scopes" data-ng-controller="OAuthProviderScopeController as scopeCtrl">
            <div class="bx--form__row">
              <div class="bx--form__row-item">
                <button title="{{::'api_security_oauth_scope_delete' | translate}}" aria-label="{{::'api_security_oauth_scope_delete' | translate}}" class="iconOnlyButton material-icons deleteScopeButton" data-ng-click="scopeCtrl.removeScope()">delete</button>
              <bx-input-container>
                <label>{{::'api_security_oauth_scope_name' | translate}}</label>
                <input data-ng-model="scopeCtrl.$oauthScopeName" data-ng-model-options="{getterSetter: true, updateOn: 'blur'}"/>
              </bx-input-container>
              <bx-input-container>
                <label>{{::'api_security_oauth_scope_description' | translate}}</label>
                <input data-ng-model="selectedOauth.scopes[oauthScopeName]" data-ng-model-options="{debounce:500}"/>
              </bx-input-container>
              </div>
            </div>
          </div>
        <div class="bx--form__legend">
          {{::'objects_oauth_grant_type' | translate}}
        </div>
        <div class="bx--form__row-item">
          <bx-checkbox
            aria-label="implicit"
            ng-model="$grantTypeImplicit"
            ng-model-options="{getterSetter: true, debounce: 500}"
            bx-prevent-default="true">
            <span>{{::'api_security_flow_implicit' | translate}}</span>
          </bx-checkbox>
        </div>
        <div class="bx--form__row-item">
          <bx-checkbox
            aria-label="application"
            ng-model="$grantTypeApplication"
            ng-model-options="{getterSetter: true, debounce: 500}"
            bx-prevent-default="true">
            <span>{{::'api_security_flow_application' | translate}}</span>
          </bx-checkbox>
        </div>
        <div class="bx--form__row-item">
          <bx-checkbox
            aria-label="access code"
            ng-model="$grantTypeAccessCode"
            ng-model-options="{getterSetter: true, debounce: 500}"
            bx-prevent-default="true">
            <span>{{::'api_security_flow_access_code' | translate}}</span>
          </bx-checkbox>
        </div>
        <div class="bx--form__legend">
          {{::'objects_oauth_client_type' | translate}}
        </div>
        <div class="bx--form__row-item">
          <bx-checkbox
            aria-label="confidential"
            ng-model="$clientTypeConfidential"
            ng-model-options="{getterSetter: true, debounce: 500}"
            bx-prevent-default="true">
            <span>{{::'objects-oauth-client-confidential' | translate}}</span>
          </bx-checkbox>
        </div>
        <div class="bx--form__row-item">
          <bx-checkbox
            aria-label="public"
            ng-model="$clientTypePublic"
            ng-model-options="{getterSetter: true, debounce: 500}"
            bx-prevent-default="true">
            <span>{{::'objects-oauth-client-public' | translate}}</span>
          </bx-checkbox>
        </div>
        <div class="bx--form__legend">
          {{::'objects-oauth-endpoint' | translate}}
        </div>
        <bx-input-container>
          <label>{{'objects-oauth-apic-authorization-endpoint' | translate}}</label>
          <input data-ng-model="selectedOauth['apic-authorize-endpoint']" required/>
        </bx-input-container>
        <bx-input-container>
          <label>{{::'objects-oauth-apic-token-endpoint' | translate}}</label>
          <input data-ng-model="selectedOauth['apic-token-endpoint']" required/>
        </bx-input-container>
        <bx-input-container>
          <md-switch md-no-ink class="md-primary md-block fullWidth" aria-label="{{::'objects_oauth_enable_tokens_refresh' | translate}}" data-ng-model="$introspection" data-ng-model-options="{getterSetter: true, debounce: 500}">{{::'objects_oauth_enable_tokens_refresh' | translate}}</md-switch>
          <div data-ng-show="$introspection()">
            <label>{{::'objects-oauth-apic-introspect-endpoint' | translate}}</label>
            <input data-ng-model="selectedOauth['apic-introspect-endpoint']"/>
          </div>
        </bx-input-container>
        <bx-input-container>
          <label>{{::'objects-oauth-apic-token-secret' | translate}}</label>
          <input readonly data-ng-model="selectedOauth['apic-token-secret'].name"/>
        </bx-input-container>
        <div class="bx--form__legend">
          {{::'api_oauth_tokens_access' | translate}}
        </div>
        <div class="bx--form__row-item">
          <label class="bx--form__label">{{::'api_oauth_tokens_ttl' | translate}}</label>
          <bx-input-number aria-label="{{::'api_oauth_tokens_ttl' | translate}}" type="number" min="1" max="63244800" data-ng-model="selectedOauth['apic-access-token-ttl']"/>
        </div>
        <div class="bx--form__row-item">
          <label class="bx--form__label">{{::'objects-oauth-apic-maximum-consent' | translate}}</label>
          <div class="bx--form__row-item">
            <label class="bx--form__label">{{::'api_oauth_tokens_ttl' | translate}}</label>
            <bx-input-number aria-label="MaxConsent" type="number" min="0" max="252979200" data-ng-model="selectedOauth['apic-maximum-consent-ttl']"/>
          </div>
        </div>
        <md-switch md-no-ink data-ng-show="grantSupportsRefreshTokens" class="md-primary md-block fullWidth" aria-label="{{::'api_oauth_tokens_refresh' | translate}}" data-ng-model="$refreshTokens" data-ng-model-options="{getterSetter: true, debounce: 500}">{{::'api_oauth_tokens_refresh' | translate}}</md-switch>
        <div data-ng-show="grantSupportsRefreshTokens && $refreshTokens();">
          <div class="bx--form__row-item">
            <label class="bx--form__label">{{::"objects-oauth-refresh-toekn-limit" | translate}}</label>
            <bx-input-number aria-label="{{::'objects-oauth-refresh-toekn-limit' | translate}}" type="number" min="0" max="4096" data-ng-model="selectedOauth['apic-refresh-token-limit']"/>
          </div>
          <div class="bx--form__row-item">
            <label class="bx--form__label">{{::"api_oauth_tokens_ttl" | translate}}</label>
            <bx-input-number aria-label="{{::'api_oauth_tokens_ttl' | translate}}" type="number" min="2" max="252979200" data-ng-model="selectedOauth['apic-refresh-token-ttl']" data-ng-disabled="selectedOauth['apic-refresh-token'].count <=0"/>
          </div>
        </div>
      </section>
    </form>
</div>
<div class="bx--modal__buttons">
  <div class="bx--modal__buttons-container">
    <button data-ng-click="cancel()" class="bx--btn--secondary" type="button">{{::'cancel' | translate}}</button>
    <button data-ng-click="commit()" class="bx--btn" type="button" data-ng-disabled="!OauthForm.$valid || modifyingObject">{{::'save' | translate}}</button>
  </div>
</div>
