<!--
/********************************************************* {COPYRIGHT-TOP} ***
* Licensed Materials - Property of IBM
* 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
*
* (C) Copyright IBM Corporation 2017
*
* All Rights Reserved.
* US Government Users Restricted Rights - Use, duplication or disclosure
* restricted by GSA ADP Schedule Contract with IBM Corp.
********************************************************** {COPYRIGHT-END} **/
-->
<div data-ng-controller="UserRegistriesController">
    <div class="layout whiteBackground sectionTitleBanner bx--inner__title">
        <button class="iconOnlyButton" style="font-size: 16px; padding: 8px 0px 0px 0px; border-right: 1px solid #e5e5e5" data-ng-click="toggleToc();"  title="{{::'community-hide-menu' | translate}}"><span data-ng-class="{'rotate180': hideToc}" class="material-icons transition200">navigate_before</span></button>
        <span class="sectionTitle">{{::sectionTitle | translate}}</span>
    </div>
    <div class="secondaryBackground centerColumn apiSelfClear layout fullWidth searchBanner bx--inner__search__banner">
      <div class="sectionAction displayInline dropdown registryMenu" data-is-open="idpCreateMenuIsOpen" dropdown data-ng-show="permissions['org_organizationManagement/manage']">
        <button class="bx--btn" role="button" dropdown-toggle>
          {{::'add' | translate}}
          <bx-icon class="bx--btn--right-icon__icon" icon="add--glyph"></bx-icon>
        </button>
        <ul class="dropdown-menu exclude-this" role="menu" aria-label="{{::'environmentIdentityProvider' | translate}}" tabindex="0" onkeypress="idpCreateMenuIsOpen = true;">
          <li role="menuitem" class="registryMenuItem"><a href="javascript:void(0)" data-ng-click="newLdapProfile()">{{::'idpNewLdapProfile' | translate}}</a></li>
          <li role="menuitem" class="registryMenuItem" data-ng-show="context !== 'cmc'"><a href="javascript:void(0)" data-ng-click="newLdapProfileAPIOnly()">{{::'idpNewLdapProfileAPIOnly' | translate}}</a></li>
          <li role="menuitem" class="registryMenuItem"><a href="javascript:void(0)" data-ng-click="newAuthUrlProfile()">{{::'idpNewAuthUrlRegistry' | translate}}</a></li>
          <li role="menuitem" class="registryMenuItem" data-ng-show="context !== 'cmc'"><a href="javascript:void(0)" data-ng-click="newLocalProfile()">{{::'idpNewLocalRegistry' | translate}}</a></li>
          <li role="menuitem" class="registryMenuItem" data-ng-show="context !== 'cmc'"><a href="javascript:void(0)" data-ng-click="newScimProfile()">{{::'idpNewScimUserRegistry' | translate}}</a></li>
        </ul>
      </div>
      <div class="displayInline itsAllRelative flex bx--search" role="search">
          <bx-icon class="bx--search__icon--magnifier" icon="search"></bx-icon>
          <label for="search__input" class="bx--search__label">Search</label>
        <input type="search" class="bx--search__input" id="search__input" aria-label="{{::'search' | translate}}" placeholder="{{::'search' | translate}}" data-ng-model="$parent.query">
        <button type="reset" class="iconOnlyButton" data-ng-click="$parent.query = '';" data-ng-show="query" title="{{::'resetFilter' | translate}}"><div class="closeIcon"></div></button>
      </div>
    </div>

  <div class="secondaryBackground centerColumn">
    <div class="bx--responsive-table-container">
      <table class="bx--responsive-table">
        <thead class="bx--table-head">
          <tr class="bx--table-row">

            <th class="bx--table-header bx--table-sort bxTablePaddingLeft" ng-class="{'bx--table-sort--ascending' : orderDirection, 'bx--table-sort-active' : orderProp == 'title'}" data-ng-click="orderProp = 'title'; orderDirection = !orderDirection;">
              <span>{{::'displayName' | translate}}</span>
              <bx-icon class="bx--table-sort__svg" icon="caret--down"></bx-icon>
            </th>

            <th class="bx--table-header bx--table-sort" ng-class="{'bx--table-sort--ascending' : orderDirection, 'bx--table-sort-active' : orderProp == '$$type'}" data-ng-click="orderProp = '$$type'; orderDirection = !orderDirection;">
              <span>{{::'type' | translate}}</span>
              <bx-icon class="bx--table-sort__svg" icon="caret--down"></bx-icon>
            </th>

            <th class="bx--table-header bx--table-sort" ng-class="{'bx--table-sort--ascending' : orderDirection, 'bx--table-sort-active' : orderProp == 'description'}" data-ng-click="orderProp = 'description'; orderDirection = !orderDirection;">
              <span>{{::'description' | translate}}</span>
              <bx-icon class="bx--table-sort__svg" icon="caret--down"></bx-icon>
            </th>

            <th class="bx--table-header bxTablePaddingRight"></th>
          </tr>
        </thead>
        <tbody class="bx--table-body">

          <tr class="bx--table-row bx--parent-row" data-ng-show="objects && objects.length === 0">
            <td class="bxTablePaddingLeft table-empty" colspan="4">{{'objects-no-user-registries' | translate}}</td>
          </tr>

          <tr class="bx--table-row bx--parent-row" data-ng-show="objects && objects.length > 0 && filteredObjects.length === 0">
            <td class="bxTablePaddingLeft" colspan="4">{{'objects-no-matching-user-registries' | translate}}</td>
          </tr>

          <tr class="bx--table-row bx--parent-row" ng-class-even="'bx--parent-row--even'" data-ng-repeat="registry in filteredObjects = (objects | userRegistryQuery: query | orderBy: orderProp: orderDirection)" data-ng-controller="ObjectsUserRegistryController">

            <td class="bxTablePaddingLeft">
              <span data-ng-bind-html="registry.title | highlight: query"></span>
              <button style="margin-top: -2px;" class="material-icons iconOnlyButton alignMiddle infoIcon" data-ng-click="showTooltip = !showTooltip;" data-tooltip-is-open="showTooltip" data-tooltip-html-unsafe="{{registry.name | highlight: query}}" data-tooltip-placement="right">info_outline</button>
            </td>

            <td data-ng-bind-html="registry.$$type | highlight: query"></td>
            <td data-ng-bind-html="registry.description | highlight: query"></td>

            <td class="bx--table-overflow bxTablePaddingRight">
              <div class="dropdown actionMenu" dropdown data-is-open="menuOpen" data-ng-show="permissions['org_organizationManagement/manage'] && registry.orgId">
                <bx-overflow-menu>
                  <bx-overflow-menu-item item-text="{{::'objects-edit-user-registry' | translate}}" data-ng-click="editUserRegistry($event, registry);">
                  </bx-overflow-menu-item>

                  <bx-overflow-menu-item item-text="{{::'objects-delete-user-registry' | translate}}" data-ng-click="deleteItem(registry, 'objects-deleting-user-registry');" warn-user="true">
                  </bx-overflow-menu-item>
                </bx-overflow-menu>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
      <div class="spinnerOverlay" data-ng-if="objects.$resolved === false">
      <div class="spinner"></div>
    </div>
  </div>
</div>
