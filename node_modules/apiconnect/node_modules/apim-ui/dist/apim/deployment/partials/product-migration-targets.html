<!--
/********************************************************* {COPYRIGHT-TOP} ***
* Licensed Materials - Property of IBM
* 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
*
* (C) Copyright IBM Corporation 2017
*
* All Rights Reserved.
* US Government Users Restricted Rights - Use, duplication or disclosure
* restricted by GSA ADP Schedule Contract with IBM Corp.
********************************************************** {COPYRIGHT-END} **/
-->
<h2 class="bx--modal-content__heading" role="banner" aria-label="{{::'product_manage_migration_targets' | translate}}">
  <div class="bx--form__legend floatLeft">{{::'product_manage_migration_targets' | translate}}</div>
  <div class="bx--form__legend floatRight">{{currentPage}} / 2</div>
  <div class="clearBoth"></div>
</h2>
<button title="Close" class="bx--modal__close" type="button" data-ng-click="cancel();" tabindex="-1">
  <bx-icon class="bx--modal__close--icon" icon="close"></bx-icon>
</button>
<div class="bx--modal-content webapi" data-ng-switch="currentPage">
  <div data-ng-switch-default>
    <h5 style="margin-bottom: 15px;">{{::'product_manage_select_migration_target' | translate}}</h5>
    <div class="bx--search bx--search--sm" role="search">
      <label for="search__input" class="bx--search__label">Search</label>
      <input type="search" class="bx--search__input" id="search__input" data-ng-model="productVersionQuery" type="text" spellcheck="false" title="{{::'find' | translate}}" placeholder="{{::'find' | translate}}">
    </div>
    <div class="primaryBorder" style="margin-bottom: 15px;">
      <div class="tableHeaderBackground minimalProductVersion bxTableHeader" style="border-top: none;">
        <div class="column manageProductSimpleNameColumn">{{::'apiShortName' | translate}}</div>
        <div class="column manageProductStateColumn">{{::'deploymentState' | translate}}</div>
      </div>
      <ul class="simpleList productVersions cardContainer">
        <li data-ng-repeat="productVersion in filteredProductVersions = (productVersions | deploymentNameOnlyQuery: productVersionQuery | otherPublishedOrDeprecatedProductVersions: productVersion)" ng-class-even="'bxTableRowEven'" ng-class-odd="'bxTableRowOdd'">
          <apim-deployed-product-version data-ng-click="productVersionSelected(productVersion)" class="minimalProductVersion"></apim-deployed-product-version>
        </li>
      </ul>
      <div class="mediumPadding" data-ng-show="filteredProductVersions.length == 0">{{productVersions | deploymentProductReplaceNoDescriptors}}</div>
    </div>
  </div>
  <div data-ng-switch-when="2">
    <h5 style="margin-bottom: 15px;">{{::'product_manage_migration_targets_plans' | translate}}</h5>
    <div class="tableHeaderBackground" style="padding-left: 10px;">
      <div class="column halfColumn">
        <div>{{::'product_manage_migrate_source' | translate}}</div>
        <h3 style="margin-bottom: 10px;">{{productVersion.document.info.title}}&nbsp;&nbsp;{{productVersion.document.info.version}}</h3>
      </div>
      <div class="column halfColumn">
        <div>{{::'product_manage_migrate_target' | translate}}</div>
        <h3 style="margin-bottom: 10px;">{{selectedProductVersion.document.info.title}}&nbsp;&nbsp;{{selectedProductVersion.document.info.version}}</h3>
      </div>
    </div>
    <form name="$parent.productMappings" class="bx--form">
      <ul class="simpleList">
        <li class="secondaryBorder borderBottom" style="padding: 10px;" data-ng-repeat="plan in productVersion.dependents.PLANVERSION">
          <div class="bx--select labeledSelect">
            <label class="bx--form__label">{{plan.planDisplayName}}</label>
            <select class="productPlanSelector bx--select__input" data-ng-model="planTargets[plan.planName]" title="{{::'productMigrateSelectTarget' | translate}}">
              <option value="__none__">{{::'product_manage_migration_targets_none' | translate}}</option>
              <option data-ng-repeat="otherPlan in selectedProductVersion.dependents.PLANVERSION" value="{{otherPlan.planName}}">{{otherPlan.planDisplayName}}</option>
            </select>
            <bx-icon class="bx--select__arrow" icon="caret--down"></bx-icon>
          </div>
        </li>
      </ul>
    </form>
  </div>
</div>
<div class="bx--modal__buttons" role="contentinfo" aria-label="{{::'footerSectionLabel' | translate}}">
  <div class="bx--modal__buttons-container floatLeft">
    <button class="bx--btn--secondary floatLeft no-animate" type="button" data-ng-show="currentPage > 1" data-ng-click="currentPage = 1">
      {{::'product_lifecycle_back' | translate}}
    </button>
  </div>
  <div class="bx--modal__buttons-container">
    <button class="bx--btn--secondary" type="button" data-ng-click="cancel()">
      {{::'cancel' | translate}}
    </button>
    <button class="bx--btn no-animate" type="button" data-ng-show="currentPage < 2" data-ng-disabled="!selectedProductVersion" data-ng-click="next()">
      {{::'product_lifecycle_next' | translate}}
    </button>
    <button class="bx--btn no-animate" type="button" data-ng-show="currentPage == 2" data-ng-disabled="!productMappings.$valid" data-ng-click="setMigrationTargetsForVersion(selectedProductVersion)">
      {{::'ok' | translate}}
    </button>
  </div>
</div>
