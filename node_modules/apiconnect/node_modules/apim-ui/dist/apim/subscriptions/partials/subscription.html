<!--
/********************************************************* {COPYRIGHT-TOP} ***
* Licensed Materials - Property of IBM
* 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
*
* (C) Copyright IBM Corporation 2017
*
* All Rights Reserved.
* US Government Users Restricted Rights - Use, duplication or disclosure
* restricted by GSA ADP Schedule Contract with IBM Corp.
********************************************************** {COPYRIGHT-END} **/
-->
<div class="subscriptionView" data-ng-class="{backgroundDisabled: beingDeleted}" data-ng-controller="SubscriptionController as subscriptionController">
	<div class="card primaryBorder app" data-ng-class="{'open': showSubscriptionDetails}">
		<div class="subscriptionSummary clickable" data-ng-click="$event.originalEvent.dropdown || (showSubscriptionDetails = !showSubscriptionDetails)" tabindex="-1">
			<div class="displayInline subscriptionIconColumn">
				<div class="subscriptionIcon" data-ng-attr-style="{{appImageUrlStyle}}"></div>
			</div><div class="displayInline alignTop subscriptionNameColumn">
				<a href="javascript:;" class="displayInline boundedText bold" title="{{subscription.application.appName}}" data-ng-click="showSubscriptionDetails = !showSubscriptionDetails; $event.stopPropagation();" data-ng-bind-html="subscription.application.appName | highlight: query"></a>
				<div data-ng-bind-html="subscription.application.clientId | highlight: query"></div>
			</div><div class="displayInline alignTop subscriptionCountColumn highlightText">{{subscription.subs.length}}
			</div><div class="displayInline alignTop subscriptionDevColumn">
				<a href="#/catalogs/{{environment.id}}/developers/{{subscription.consumerOrg.id}}" style="max-width: 130px;" class="displayInline orgName boundedText bold">{{subscription.consumerOrg.displayName}}</a>
			</div><div class="displayInline alignTop subscriptionActionsColumn" data-ng-click="$event.stopPropagation();" tabindex="-1">
				<div class="displayInline dropdown publishMenu" dropdown data-is-open="publishIsOpen">
					<button class="iconOnlyButton dropdown-toggle menuDropdown" data-ng-click="$event.originalEvent.dropdown = true" role="button" title="{{::'ttManage' | translate}}" dropdown-toggle><div class="material-icons">more_horiz</div></button>
					<ul class="dropdown-menu pull-right" role="menu" onkeypress="publishIsOpen" aria-label="{{::'ttManage' | translate}}">
						<li data-ng-if="subscription.consumerOrg.id == orgId" role="menuitem" class="publishingMenuItem" aria-label="{{::'subscriptionsSubscribeApp' | translate}}"><a href="javascript:;" data-ng-click="subscribeApp();">{{::'subscriptionsSubscribeApp' | translate}}</a></li>
						<li data-ng-if="subscription.consumerOrg.id == orgId" role="menuitem" class="publishingMenuItem" aria-label="{{::'subscriptionsDeleteApp' | translate}}"><a href="javascript:;" data-ng-click="deleteApp();">{{::'subscriptionsDeleteApp' | translate}}</a></li>
						<li role="menuitem" class="publishingMenuItem" data-ng-show="subscription.application.state.toLowerCase() != 'suspended'" aria-label="{{::'subscriptionsSuspendApp' | translate}}"><a href="javascript:;" data-ng-click="suspendApp();">{{::'subscriptionsSuspendApp' | translate}}</a></li>
						<li role="menuitem" class="publishingMenuItem" data-ng-show="subscription.application.state.toLowerCase() == 'suspended'" aria-label="{{::'subscriptionsResumeApp' | translate}}"><a href="javascript:;" data-ng-click="resumeApp();">{{::'subscriptionsResumeApp' | translate}}</a></li>
						<li role="menuitem" class="publishingMenuItem" aria-label="{{::'subscriptionsAppAnalytics' | translate}}"><a href="javascript:;" data-ng-click="appAnalytics();">{{::'subscriptionsAppAnalytics' | translate}}</a></li>
					</ul>
				</div>
			</div>
		</div>
		<div class="subscriptionList" data-ng-show="showSubscriptionDetails">
			<div class="tableHeaderBackground apiSelfClear">
				<div class="column subscriptionProductColumn">{{::'subscriptionsProductPlan' | translate}}
				</div><div class="column subscriptionSubActionColumn"></div>
			</div>
			<ul class="subscriptionsList">
				<li data-ng-if="subscription.subs.length == 0" style="padding: 10px 15px;">{{::'subscriptionsNoSubscriptions' | translate}}</li>
				<li data-ng-repeat="sub in subscription.subs">
					<div class="sub secondaryBorder secondaryHighlight">
						<div class="displayInline subscriptionProductColumn"><span class="bold">{{sub.product.title}}</span> {{sub.product.version}} / {{sub.plan.title}}
						</div><div class="displayInline subscriptionSubActionColumn">
							<div class="displayInline dropdown publishMenu" dropdown data-is-open="subscriptionIsOpen">
								<button class="iconOnlyButton dropdown-toggle menuDropdown" data-ng-click="$event.originalEvent.dropdown = true" role="button" title="{{::'ttManage' | translate}}" dropdown-toggle><div class="material-icons">more_horiz</div></button>
								<ul class="dropdown-menu pull-right" role="menu" onkeypress="subscriptionIsOpen" aria-label="{{::'ttManage' | translate}}">
									<li data-ng-if="subscription.consumerOrg.id == orgId" role="menuitem" class="publishingMenuItem" aria-label="{{::'subscriptionsDeleteSubscription' | translate}}"><a href="javascript:;" data-ng-click="deleteSubscription(sub);">{{::'subscriptionsDeleteSubscription' | translate}}</a></li>
									<li role="menuitem" class="publishingMenuItem" aria-label="{{::'subscriptionsAnalytics' | translate}}"><a href="javascript:;" data-ng-click="appAnalytics();">{{::'subscriptionsAnalytics' | translate}}</a></li>
								</ul>
							</div>
						</div>
					</div>
				</li>
			</ul>
		</div>
	</div>
</div>
