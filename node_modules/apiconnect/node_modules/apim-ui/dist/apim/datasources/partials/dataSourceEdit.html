<!--
/********************************************************* {COPYRIGHT-TOP} ***
* Licensed Materials - Property of IBM
* 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
*
* (C) Copyright IBM Corporation 2017
*
* All Rights Reserved.
* US Government Users Restricted Rights - Use, duplication or disclosure
* restricted by GSA ADP Schedule Contract with IBM Corp.
********************************************************** {COPYRIGHT-END} **/
-->
<div class="datasource-editor amp-margin" apic-save-key="save()">
  <div class="bannerActions" data-ng-show="!xhrProcessing">
    <div class="dijitInline contentBox saveButton">
      <div class="buttonAndLabel" style="position: relative; text-align: center;" title="{{'save' | translate}}">
        <button aria-label="{{::'save' | translate}}"
          title="{{::'save' | translate}}" data-ng-disabled="!checkDirtyDataSource()"
          data-ng-click="save()" class="highVisButton iconOnlyButton">
          <div class="material-icons">save</div>
        </button>
      </div>
    </div>
    <div class="dijitInline contentBox"
      ng-show="dataSource.connector.features.discovery">
      <div class="buttonAndLabel" title="{{::'DSDModel' | translate}}"
        style="position: relative; text-align: center;">
        <button aria-label="{{::'DSDModel' | translate}}"
          title="{{::'DSDModel' | translate}}" class="iconOnlyButton"
          data-ng-disabled="checkDirtyDataSource()"
          ui-sref="datasourceDiscover({id:dataSource.id, all:dataSource.all})">
          <div class="material-icons">find_in_page</div>
        </button>
      </div>
    </div>
    <div class="dijitInline contentBox"
      ng-show="dataSource.connector.features.migration">
      <div class="buttonAndLabel" title="{{'save' | translate}}"
        style="position: relative; text-align: center;">
        <button aria-label="{{::'migrate' | translate}}"
          title="{{::'migrate' | translate}}" class="iconOnlyButton"
          data-ng-disabled="checkDirtyDataSource()"
          data-ng-click="migrateModels(dataSource)">
          <div class="material-icons">swap_horiz</div>
        </button>
      </div>
    </div>
    <div class="dijitInline contentBox">
      <div class="buttonAndLabel"
        style="position: relative; text-align: center;"
        title="{{'testDataSourceConnection' | translate}}">
        <button aria-label="{{::'testDataSourceConnection' | translate}}"
          title="{{::'testDataSourceConnection' | translate}}"
          class="iconOnlyButton" ng-disabled="isTesting"
          data-ng-click="confirmDataSourceTest(dataSource)">
          <div class="material-icons">directions_run</div>
        </button>
      </div>
    </div>
  </div>
  <div data-ng-class="{'spinner': xhrProcessing}"></div>
  <div class="centerColumn" data-ng-show="!xhrProcessing">
    <div class="expanded">
      <div class="centerColumn dialogBody listingColumn stretch amp-margin">
        <section class="dialogSection">
          <bx-input-container>
            <label>{{::"name" | translate}}</label>
            <input ng-model="dataSource.name" readonly />
          </bx-input-container>
          <div class="bx--form__row-item">
            <div class="bx--select labeledSelect">
              <label for="selectDB" class="bx--form__label">{{::"connector" | translate}}</label>
              <select id="selectDB" class="bx--select__input"
                      ng-model="dataSource.connector"
                      ng-model-options="{trackBy: '$value.name'}"
                      placeholder="{{ 'connector' | translate }}"
                      ng-options="type.description for type in connectorTypes | orderBy:'-installed'">
              </select>
              <bx-icon class="bx--select__arrow" icon="caret--down"></bx-icon>
            </div>
          </div>
          <div ng-show="!dataSource.connector.installed" class="bx--form__row-item installConnector">
            <i class="material-icons">warning</i>
            {{ ::'connectUnavailableMessage' | translate }}
            <span ng-if="dataSource.connector.name != 'oracle'">
                &nbsp;<a href="" ng-click="showInstallConnectorModal()">{{::'installConnector' | translate}}</a>.
              </span>
            <span ng-if="dataSource.connector.name == 'oracle'">
                &nbsp;{{::'installOracleDocs' | translate }}
                <a href="https://docs.strongloop.com/display/APIC/Oracle+connector"
                   target="_new">https://docs.strongloop.com/display/APIC/Oracle+connector</a>
              </span>
          </div>
          <div ng-repeat="(name, setting) in dataSource.connector.settings">
            <md-tooltip ng-if="setting.description">
              {{setting.description}}
            </md-tooltip>
            <bx-input-container ng-if="getInputType(setting) !== 'checkbox'">
              <label>
                {{'dsSetting.' + name | translate}}
              </label>
              <input ng-model="dataSource[name]" transform-json
                     ng-model-options="{ debounce: { 'default': 500 } }"
                     type="{{getInputType(setting)}}" />
            </bx-input-container>
            <bx-input-container ng-if="getInputType(setting) == 'checkbox'">
              <bx-checkbox ng-model="dataSource[name]" transform-json ng-model-options="{ debounce: { 'default': 500 } }">
                {{ 'dsSetting.' + name | translate }}
              </bx-checkbox>
            </bx-input-container>
          </div>
          <div class="bx--form__row-item">
            <label class="bx--form__label">{{::"DSDOptions" | translate}}</label>
            <div>
              <md-checkbox class="md-primary" role="checkbox" ng-model="dataSource.all" ng-change="change()">{{::'DSDFetchAllSchemas' | translate }}</md-checkbox>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>
</div>
