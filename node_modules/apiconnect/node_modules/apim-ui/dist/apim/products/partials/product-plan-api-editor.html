<!--
/********************************************************* {COPYRIGHT-TOP} ***
* Licensed Materials - Property of IBM
* 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
*
* (C) Copyright IBM Corporation 2017
*
* All Rights Reserved.
* US Government Users Restricted Rights - Use, duplication or disclosure
* restricted by GSA ADP Schedule Contract with IBM Corp.
********************************************************** {COPYRIGHT-END} **/
-->
<div class="productApi" data-ng-show="apiSelected || !showSelectedOnly" data-ng-controller="ProductPlanApiController">
    <div class="headline secondaryHighlight layout">
        <div class="productAPIExpanderColumn">
        </div><div class="productAPITitleColumn">
        	<bx-checkbox data-ng-model="apiSelected" data-ng-model-options="{getterSetter:true}" aria-label="apiVersion.info.title">
        		<span data-ng-show="apiVersion">{{apiVersion.info.title}}</span>
	            <span data-ng-show="apiVersion">{{apiVersion.info.version}}</span>
	            <span data-ng-show="!apiVersion">{{api.$ref}}{{api.id}}{{api.name}}</span>
        	</bx-checkbox>
        </div><div class="productAPIActionsColumn">
            <button style="margin: 0; padding: 0;" class="iconOnlyButton material-icons" role="button" title="{{::'product_api_operations_show' | translate}}" data-ng-click="expandContent()" data-ng-class="{'rotate180': showApiContent}">keyboard_arrow_down</button>
        </div>
    </div>
    <div data-ng-class="{'spinner': loadingOperations}"></div>
    <div class="expandedContent" data-ng-show="showApiContent">
        <div class="loadingAnimation38" data-ng-show="xhrProcessing" style="margin-bottom: 20px;"></div>
        <ul class="simpleList">
            <li class="emptyCollectionMessage" data-ng-if="apiVersion.operations && apiVersion.operations.length == 0">{{::'noResourcesAddedYet' | translate}}</li>
            <li data-ng-show="operationSelected() || !showSelectedOnly" class="apiOperation secondaryHighlight secondaryBorder" data-ng-class="{showRateLimit: showRateLimitContent()}" data-ng-controller="ProductPlanApiOperationController as operationCtrl" data-ng-repeat="operation in apiVersion.operations | orderBy: ['path', 'verb']">
                <div class="productAPIExpanderColumn">&nbsp;
                </div><div class="productAPITitleColumn">
		        	<bx-checkbox data-ng-model="operationSelected" data-ng-model-options="{getterSetter:true}" data-ng-disabled="!$parent.apiSelected()">
	                    <span class="operationName" title="{{::operation | operationDisplayName}}">{{::operation | operationDisplayName}}</span>
		        	</bx-checkbox>
                    <div data-ng-if="showRateLimitContent()">
                      <label class="bx--form__label">{{::'product_rate_limits' | translate}}</label>
                        <button style="vertical-align: top;" data-ng-disabled="!editable" data-ng-click="addRateLimit()" class="displayInline iconOnlyButton material-icons" title="{{::'product_rate_limit_add' | translate}}" aria-label="{{::'product_rate_limit_add' | translate}}">add_circle_outline</button>
                        <md-switch aria-label="{{::'rateLimitUnlimited' | translate}}" data-ng-model="$unlimitedRateLimit" data-ng-model-options="{getterSetter: true}">{{::'rateLimitUnlimited' | translate}}</md-switch>
                        <div data-ng-show="!$unlimitedRateLimit()">
                            <div data-ng-if="planApiOperation['rate-limit']">
                                <apim-rate-limit style="display: inline-flex;" model="planApiOperation['rate-limit']"></apim-rate-limit>
                                <button style="vertical-align: bottom; height: 45px; float: right;" data-ng-disabled="!editable" data-ng-click="deleteRateLimit();" class="displayInline iconOnlyButton material-icons" title="{{::'product_rate_limit_add' | translate}}" aria-label="{{::'product_rate_limit_delete' | translate}}">delete</button>
                            </div>
                            <div data-ng-repeat="(rateLimitName, rateLimit) in planApiOperation['rate-limits']" data-ng-controller="OperationNamedRateLimitController" style="display: inline-flex;">
                                <input id="{{$id}}_rateLimitName" class="bx--text__input" type="text" data-ng-model="$rateLimitName" data-ng-model-options="{getterSetter:true, updateOn:'blur'}" style="margin-right: 5px;" data-ng-keyUp="setDirty(true)" title="{{::'productRateLimitName' | translate}}"/>
                                <apim-rate-limit style="display: inline-flex;" model="rateLimit"></apim-rate-limit>
                                <button style="vertical-align: bottom; height: 45px; float: right;" data-ng-disabled="!editable" data-ng-click="deleteRateLimit(rateLimitName)" class="displayInline iconOnlyButton material-icons" title="{{::'product_rate_limit_delete' | translate}}" aria-label="{{::'product_rate_limit_delete' | translate}}">delete</button>
                            </div>
                        </div>
                    </div>
                </div><div class="productAPIRateLimitConfigColumn" data-ng-show="!showRateLimitContent() && operationSelected()">
                    <button style="margin-right: 5px;" class="textOnlyButton" role="button" title="{{::'rateLimitOverride' | translate}}" data-ng-click="setRateLimit($event)">{{::'rateLimitOverride' | translate}}</button>
                </div><div class="productAPIRateLimitConfigColumn" data-ng-show="showRateLimitContent() && operationSelected()">
                    <button style="margin-right: 5px;" class="textOnlyButton" role="button" title="{{::'rateLimitResetToPlan' | translate}}" data-ng-click="clearRateLimit($event)">{{::'rateLimitResetToPlan' | translate}}</button>
                </div>
            </li>
        </ul>
    </div>
</div>
