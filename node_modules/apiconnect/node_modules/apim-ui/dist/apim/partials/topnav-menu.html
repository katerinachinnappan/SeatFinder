<!--
/********************************************************* {COPYRIGHT-TOP} ***
* Licensed Materials - Property of IBM
* 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
*
* (C) Copyright IBM Corporation 2017
*
* All Rights Reserved.
* US Government Users Restricted Rights - Use, duplication or disclosure
* restricted by GSA ADP Schedule Contract with IBM Corp.
********************************************************** {COPYRIGHT-END} **/
-->
<div class="apim-topnav-menu">
  <div class="main-nav-button-container tooltipContainer"
       ng-if="offlineMode">
    <!--  main button container -->
    <div class="displayInline" ng-controller="StagingController">
      <button class="iconOnlyButton"
              ng-click="handleStagingClick()"
              data-toggle="dropdown"
              title="{{::'publish' | translate}}">
        <div class="material-icons" aria-label="{{::'publish' | translate}}">cloud_upload</div>
        <div class="nav-label showIfLargeScreen">{{::'publish' | translate}}</div>
      </button>
      <div class="staging-dropdown dropdown"
           dropdown
           data-is-open="stagingDropdownOpen">
        <ul class="dropdown-menu pull-right"
            aria-label="staging-dropdown"
            tabindex="3">
          <div ng-if="bluemixStagingTargets.length > 0">
            <div class="dropdown-header" translate>publishTargetBluemixHeader</div>
            <li role="menuitem">
              <div class="dropdown-item"
                   ng-repeat="target in bluemixStagingTargets"
                   ng-click="openPublishOptions(target.info)">
                <div ng-if="target.info.space && !target.info.space.none">
                  <span class="staging-nav-key" translate>publishTargetSpaceSelection</span>
                  <span>{{target.info.space.title}}</span>
                  <span>({{target.info.space.name}})</span>
                </div>
                <div ng-if="!target.info.catalog.none">
                  <span class="staging-nav-key" translate>publishTargetCatalogSelection</span>
                  <span>{{target.info.catalog.name}}</span>
                  <span>({{target.info.catalog.shortName}})</span>
                </div>
                <div ng-if="!target.info.app.none">
                  <span class="staging-nav-key" translate>publishTargetAppSelection</span>
                  <span>{{target.info.app.entity.name || target.info.app.name}}</span>
                </div>
                <div>
                  <span class="staging-nav-key" translate>publishTargetOrgSelection</span>
                  <span>{{target.info.org.displayName}}</span>
                  <span>({{target.info.org.name}})</span>
                </div>
              </div>
            </li>
          </div>
          <div ng-if="otherStagingTargets.length > 0">
            <div class="dropdown-header" translate>publishTargetOtherHeader</div>
            <li role="menuitem">
              <div class="dropdown-item"
                   ng-repeat="target in otherStagingTargets"
                   ng-click="openPublishOptions(target.info)">
                <div ng-if="target.info.space && !target.info.space.none">
                  <span class="staging-nav-key" translate>publishTargetSpaceSelection</span>
                  <span>{{target.info.space.title}}</span>
                  <span>({{target.info.space.name}})</span>
                </div>
                <div ng-if="!target.info.catalog.none">
                  <span class="staging-nav-key" translate>publishTargetCatalogSelection</span>
                  <span>{{target.info.catalog.name}}</span>
                  <span>({{target.info.catalog.shortName}})</span>
                </div>
                <div ng-if="!target.info.app.none">
                  <span class="staging-nav-key" translate>publishTargetAppSelection</span>
                  <span>{{target.info.app.title}}</span>
                  <span>({{target.info.app.name}})</span>
                </div>
                <div>
                  <span class="staging-nav-key" translate>publishTargetOrgSelection</span>
                  <span>{{target.info.org.displayName}}</span>
                  <span>({{target.info.org.name}})</span>
                </div>
                <div>
                  <span class="staging-nav-key" translate>publishTargetServerSelection</span>
                  <span>{{target.info.server.host}}</span>
                </div>
              </div>
            </li>
          </div>
          <hr ng-if="stagingTargets.length > 0"/>
          <li role="menuitem">
            <div class="dropdown-item select-other-target"
                 ng-click="openManageTargets()">{{'manageTargets' | translate}}</div>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <div class="main-nav-button-container"
       ng-if="isSaaS">
    <!--  main button container -->
      <button class="buttonAndLabel"
          ng-click="tryDesigner()"
          title="{{::'bluemix_try_designer' | translate}}">
        <div class="material-icons"
             aria-label="{{::'publish' | translate}}">build</div>
        <div class="nav-label displayInline showIfLargeScreen">{{::'bluemix_try_designer' | translate}}</div>
      </button>
  </div>
  <div class="main-nav-button-container">
    <button class="buttonAndLabel"
            ng-if="offlineMode"
            ng-click="navigate('explore', 'explore', 'explore')"
            title="{{::'section-explore' | translate}}">
      <div class="material-icons"
           aria-label="{{::'section-explore' | translate}}">explore</div>
      <div class="nav-label displayInline showIfLargeScreen">{{::'section-explore' | translate}}</div>
    </button>
    <div class="displayInline dropdown exploreMenu"
         ng-if="!offlineMode && permissions['org_draftApis/view']"
         dropdown
         data-is-open="exploreMenuIsOpen">
      <button class="iconOnlyButton whiteButton dropdown-toggle menuDropdown"
              id="explorebtn"
              dropdown-toggle
              role="button">
        <div class="whiteButton material-icons"
             aria-label="{{::'section-explore' | translate}}">explore</div>
        <div class="nav-label displayInline showIfLargeScreen">{{::'section-explore' | translate}}</div>
      </button>
      <ul class="dropdown-menu pull-right tooltipContainer"
          role="menu"
          onkeypress="exploreMenuIsOpen"
          aria-label="{{::'headerHelp' | translate}}">
        <li class="exploreMenuItem"
            role="menuitem"
            ng-click="navigate('explore', 'explore', 'explore')">
          <a>{{::'explorerShowDrafts' | translate}}</a>
        </li>
        <hr />
        <div class="dropdown-header">
          {{::'catalogs' | translate}}
        </div>
        <li class="exploreMenuItem"
            role="menuitem"
            ng-repeat="catalog in environments"
            id="exploreCatalog-{{catalog.shortName}}"
            tooltip-placement="left"
            tooltip-trigger="exploreTooltipEvent"
            tooltip="{{::'tour-gs-exploreCatalogTooltip' | translate}}"
            catalogname="{{catalog.shortName}}"
            ng-click="navigate('explore?source=' + catalog.shortName, 'explore?source=' + catalog.shortName, 'explore?source=' + catalog.shortName)">
          <a>{{catalog.name}}</a>
        </li>
      </ul>
    </div>
  </div>
  <div class="right-nav-button-container"
       ng-if="offlineMode">
    <button class="iconOnlyButton whiteButton material-icons"
            ng-click="showProjectSettings()"
            title="{{::'settings' | translate}}"
            aria-label="{{::'settings' | translate}}">settings</button>
  </div>
  <div class="right-nav-button-container" ng-if="!offlineMode">
    <button class="iconOnlyButton whiteButton material-icons"
            ng-click="navigate('notifications', 'notifications', 'notifications')"
            title="{{::'section-notifications' | translate}}"
            aria-label="{{::'section-notifications' | translate}}">notifications</button>
  </div>
  <div class="right-nav-button-container">
    <div class="displayInline dropdown userMenu"
         dropdown
         data-is-open="helpMenuIsOpen">
      <button class="iconOnlyButton whiteButton dropdown-toggle menuDropdown material-icons tooltipContainer"
              id="helpbtn"
              role="button"
              title="{{::'headerHelp' | translate}}"
              dropdown-toggle
              aria-label="{{::'headerHelp' | translate}}">help_outline</button>
      <ul class="dropdown-menu pull-right tooltipContainer"
          role="menu"
          onkeypress="helpMenuIsOpen"
          aria-label="{{::'headerHelp' | translate}}">
          <li role="menuitem"
            class="userMenuItem"
            ng-show="whatsNewShown"
            ng-click="showWhatsNewInfo(true)"
            aria-label="{{::'whatsnew' | translate}}">
          <a href="javascript:void(0)" tabindex="-1">{{::'whatsnew' | translate}}</a>
        </li>
        <li role="menuitem"
            class="userMenuItem"
            aria-label="{{::'helpTutorials' | translate}}"
            ng-click="track('help', 'tutorials')">
          <a href="http://www.ibm.com/support/knowledgecenter/SSMNED_5.0.0/com.ibm.apic.toolkit.doc/tutorial_cli_overview.html" target="_blank">{{::'helpTutorials' | translate}}</a>
        </li>
        <li role="menuitem"
            class="userMenuItem"
            aria-label="{{::'helpDevComm' | translate}}"
            ng-click="track('help', 'devComm')">
          <a href="https://developer.ibm.com/apimanagement/" target="_blank">{{::'helpDevComm' | translate}}</a>
        </li>
        <li role="menuitem"
            class="userMenuItem"
            aria-label="{{::'helpKC' | translate}}"
            ng-click="track('help', 'kc')">
          <a href="{{currentUser | productDocumentation: sbsToken}}" target="_blank">{{::'helpKC' | translate}}</a>
        </li>
        <li role="menuitem"
            class="userMenuItem"
            aria-label="{{::'helpForum' | translate}}"
            ng-click="track('help', 'forum')">
          <a href="https://developer.ibm.com/answers/tags/apimsaas/?community=api" target="_blank">{{::'helpForum' | translate}}</a>
        </li>
        <li role="menuitem"
            class="userMenuItem"
            aria-label="{{::'helpSupport' | translate}}"
            ng-click="track('help', 'support')">
          <a href="https://www.ibm.com/cloud/support" target="_blank">{{::'helpSupport' | translate}}</a>
        </li>
        <li role="menuitem"
            class="userMenuItem menuDivider"
            id="reopenGettingStartedBtn"
            aria-label="{{::'helpTourTurnOff' | translate}}"
            ng-if="isSaaS && location.hash.indexOf('#/admin/securegateways') < 0"
            ng-click="toggleGettingStartedMenu()"
            tooltip="{{::'reopenGettingStartedTooltip' | translate}}"
            tooltip-placement="left"
            tooltip-trigger="closeGettingStartedEvent"
            tooltip-popup-delay="300"
            tooltip-popup-close-delay="200">
          <a>{{ (!experiencedUser ? 'helpTourTurnOff' : 'helpTourTurnOn') | translate }}</a>
        </li>
        <li role="menuitem"
            class="userMenuItem menuDivider"
            id="reopenSgTourBtn"
            aria-label="{{::'helpTourTurnOff' | translate}}"
            ng-if="isSaaS && location.hash.indexOf('#/admin/securegateways') == 0"
            ng-click="toggleGettingStartedMenu()"
            tooltip="{{::'reopenGettingStartedTooltip' | translate}}"
            tooltip-placement="left"
            tooltip-trigger="closeGettingStartedEvent"
            tooltip-popup-delay="300"
            tooltip-popup-close-delay="200">
          <a>{{ (!sgTourTextOff ? 'helpTourTurnOff' : 'helpTourTurnOn') | translate }}</a>
        </li>
      </ul>
    </div>
  </div>
  <div ng-if="!offlineMode && !isSaaS"
       class="main-nav-button-container">
    <div class="dropdown"
         dropdown
         data-is-open="orgsMenuIsOpen">
      <button class="iconOnlyButton dropdown-toggle"
              role="button"
              dropdown-toggle>
        <div class="material-icons">business</div>
        <div class="nav-label">
          <div style="max-width: 100px;"
               class="boundedText"
               title="{{orgName}}">{{orgName}}</div>
          <span class="caret"></span>
        </div>
      </button>
      <ul class="dropdown-menu pull-right"
          role="menu"
          aria-label="{{::'orgMenuName' | translate}}"
          onkeypress="orgsMenuIsOpen = true;"
          tabindex="1">
        <li role="menuitem"
            ng-repeat="org in userProviderOrgs"
            ng-class="{'selectedOrg': org.id == orgId}">
          <a href=""
             ng-click="setOrganization(org, true)"
             title="{{org.displayName}}">{{org.displayName}}</a>
        </li>
      </ul>
    </div>
  </div>
  <div class="right-nav-button-container userMenuContainer">
    <div class="displayInline dropdown userMenu"
         dropdown
         data-is-open="userMenuIsOpen">
      <button id="userMenuBtn" class="iconOnlyButton whiteButton dropdown-toggle menuDropdown material-icons"
              role="button"
              title="{{::'headerUser' | translate}}"
              dropdown-toggle
              aria-label="{{::'headerUser' | translate}}">face</button>
      <ul class="dropdown-menu pull-right"
          role="menu"
          onkeypress="userMenuIsOpen"
          aria-label="{{::'headerUser' | translate}}">
        <li role="menugroup"
            class="menugroup"
            ng-if="currentUser.email"
            aria-label="{{currentUser.email}}">{{currentUser.email}}</li>
        <li role="menugroup"
            class="menugroup"
            ng-if="!currentUser.email && currentUser.name"
            aria-label="{{currentUser.name}}">{{currentUser.name}}</li>
        <li role="menuitem"
            class="userMenuItem"
            ng-show="!offlineMode"
            aria-label="{{::'section-account' | translate}}">
          <a ui-sref="account.profile">{{::'section-account' | translate}}</a>
        </li>
        <li role="menuitem"
            class="userMenuItem"
            ng-show="offlineMode"
            aria-label="{{::'section-account' | translate}}">
          <a ui-sref="account.settings">{{::'section-account' | translate}}</a>
        </li>
        <li role="menuitem"
            class="userMenuItem"
            aria-label="{{::'logout' | translate}}">
          <a href="javascript:;" ng-click="signOut();">{{::'logout' | translate}}</a>
        </li>
      </ul>
    </div>
  </div>
  <div class="right-nav-button-container userMenuContainer"
       ng-if="offlineMode">
    <div class="displayInline dropdown userMenu chatMenu"
         dropdown
         data-is-open="chatMenuIsOpen">
      <button class="iconOnlyButton whiteButton dropdown-toggle menuDropdown material-icons"
              role="button"
              dropdown-toggle
              title="{{::'analyticsLiveHelp' | translate}}"
              id="intercom-widget">chat</button>
      <ul class="dropdown-menu pull-right"
          ng-show="!enableIntercom"
          role="menu">
        <li role="menugroup"
            class="menugroup">
          <section>
            <h2>{{::'analyticsDropdownHeading' | translate}}</h2>
            <ul>
              <li>{{::'accountTrackingBullet1' | translate}}</li>
              <li>{{::'accountTrackingBullet2' | translate}}</li>
              <li>{{::'accountTrackingBullet3' | translate}}</li>
            </ul>
          </section>
          <footer>
            <button type="button"
                    class="bx--btn bx--btn--sm"
                    apim-analytics-enable="{ triggerChat: true }">{{::'analyticsEnableLiveHelp' | translate}}</button>
          </footer>
        </li>
      </ul>
    </div>
  </div>
</div>
