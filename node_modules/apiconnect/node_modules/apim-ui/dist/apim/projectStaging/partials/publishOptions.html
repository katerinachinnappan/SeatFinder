<!--
/********************************************************* {COPYRIGHT-TOP} ***
* Licensed Materials - Property of IBM
* 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
*
* (C) Copyright IBM Corporation 2017
*
* All Rights Reserved.
* US Government Users Restricted Rights - Use, duplication or disclosure
* restricted by GSA ADP Schedule Contract with IBM Corp.
********************************************************** {COPYRIGHT-END} **/
-->
<div class="staging-modal">

  <header class="modal-header" role="banner" aria-label="{{'publish' | translate}}">
    <h2 class="modal-title" ng-if="selectedPanel == 'publishProducts'" translate>publish</h2>
    <h2 class="modal-title" ng-if="selectedPanel == 'bluemix-gatherToken'" translate>bluemixLoginTitle</h2>
  </header>

  <section class="modal-body">

    <div class="fullWidth padding0-10" ng-if="selectedPanel == 'publishProducts'">
      <div class="clearLoadingOverlay flex" ng-if="xhrProcessing">
        <div class="spinner" ng-if="xhrProcessing"></div>
      </div>
      <div ng-if="publishOptions.catalog.none">
        <!-- no catalog. Can only publish app -->
        <p translate>publish-appOnlyText</p>
        <div class="fullWidth" ng-if="publishOptions.type === 'bluemix' && !publishOptions.app.new">
          <md-radio-group ng-model="publishOptions.versionOptions.inplaceUpdate">
            <md-radio-button ng-value="true">
              {{'publish-replaceExistingApp' | translate}}
              <span class="appName">{{publishOptions.app.name}}</span>
            </md-radio-button>
            <md-radio-button ng-value="false">
              {{'publish-versionApp' | translate}}
            </md-radio-button>
          </md-radio-group>
          <div class="fullWidth ng-hide" ng-show="publishOptions.versionOptions.inplaceUpdate === false" style="margin-bottom: 10px; margin-left: 20px;">
            <md-input-container style="width: 300px;">
              <label translate>newAppName</label>
              <input type="text" ng-model="publishOptions.versionOptions.newName"/>
            </md-input-container>
          </div>
        </div>
      </div>

      <div ng-if="publishOptions.app.none">
        <!-- no app. Can only publish products -->
        <p translate>publish-productsOnlyText</p>
        <div class="fullWidth">
          <md-checkbox class="md-primary fullWidth" ng-model="publishOptions.productStageOnly" aria-label="Stage product">
            {{'publish-stageOnly' | translate}}
          </md-checkbox>
          <md-checkbox class="md-primary fullWidth" ng-model="publishOptions.specificProducts" aria-label="Stage product">
            {{'publish-selectProducts' | translate}}
          </md-checkbox>
          <div class="stagingListSelector fullWidth ng-hide" ng-show="publishOptions.specificProducts" style="height: 350px; margin-left: 20px;">
            <div class="scrollable-list">
              <div class="stagingListSelectorItem" ng-repeat="product in products" ng-class="{'selected':product.selected}">
                <md-checkbox class="md-primary fullWidth" ng-model="product.selected" aria-label="Stage product">
                  {{product.info.title}} {{product.info.version}}
                </md-checkbox>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div ng-if="!publishOptions.app.none && !publishOptions.catalog.none">
        <!-- both app and catalog. allow user to choose what they want to publish-->
        <md-checkbox class="md-primary fullWidth" ng-model="publishOptions.publishApp" aria-label="Stage product">
          {{'publish-publishApp' | translate}}
        </md-checkbox>
        <div class="fullWidth ng-hide" ng-if="publishOptions.type === 'bluemix' && !publishOptions.app.new" ng-show="publishOptions.publishApp" style="margin-left: 20px; margin-bottom: 20px">
          <md-radio-group ng-model="publishOptions.versionOptions.inplaceUpdate">
            <md-radio-button ng-value="true">
              {{'publish-replaceExistingApp' | translate}}
              <span class="appName">{{publishOptions.app.name}}</span>
            </md-radio-button>
            <md-radio-button ng-value="false">
              {{'publish-versionApp' | translate}}
            </md-radio-button>
          </md-radio-group>
          <div class="fullWidth ng-hide" ng-show="publishOptions.versionOptions.inplaceUpdate === false" style="margin-bottom: 10px; margin-left: 20px; margin-right: 20px;">
            <md-input-container style="width: 300px;">
              <label translate>newAppName</label>
              <input type="text" ng-model="publishOptions.versionOptions.newName"/>
            </md-input-container>
          </div>
        </div>
        <md-checkbox class="md-primary fullWidth" ng-model="publishOptions.publishProducts" aria-label="Stage product">
          {{'publish-publishProducts' | translate}}
        </md-checkbox>
        <div class="fullWidth ng-hide" ng-show="publishOptions.publishProducts" style="margin-left: 20px;">
          <md-checkbox class="md-primary fullWidth" ng-model="publishOptions.productStageOnly" aria-label="Stage product">
            {{'publish-stageOnly' | translate}}
          </md-checkbox>
          <md-checkbox class="md-primary fullWidth" ng-model="publishOptions.specificProducts" aria-label="Stage product">
            {{'publish-selectProducts' | translate}}
          </md-checkbox>
          <div class="stagingListSelector fullWidth ng-hide" ng-show="publishOptions.specificProducts" style="height: 350px; margin-left: 20px;">
            <div class="scrollable-list">
              <div class="stagingListSelectorItem" ng-repeat="product in products" ng-class="{'selected':product.selected}">
                <md-checkbox class="md-primary fullWidth" ng-model="product.selected" aria-label="Stage product">
                  {{product.info.name}}
                </md-checkbox>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- bluemix token sign in -->

    <div class="fullWidth padding0-10 targetSignIn" ng-if="selectedPanel == 'bluemix-gatherToken'">
      <div class= "clearLoadingOverlay flex" ng-if="xhrProcessing">
        <div class="spinner" ng-if="xhrProcessing"></div>
      </div>
      <div class="fullWidth">
        <div translate>bluemixLoginText1</div>
        <div translate>bluemixLoginText2</div>
        <div class="inputWrapper bluemixLogin" data-ng-click="gatherBluemixToken();" style="margin-top: 20px">
          <button class="bluemix" id="login_button" type="submit" name="login" value="true">{{::'loginBluemix' | translate}}</button>
        </div>
      </div>
    </div>

  </section>

  <footer class="modal-footer" role="contentinfo" aria-label="{{'footerSectionLabel' | translate}}">
    <button class="cancelButton" ng-click="close()" ng-disabled="xhrProcessing" translate>cancel</button>
    <button class="createButton" ng-if="selectedPanel === 'publishProducts' && !(publishOptions.app.none || publishOptions.catalog.none)" ng-click="handlePublishClick()" ng-disabled="!publishOptions.publishApp && !publishOptions.publishProducts" translate>publish</button>
    <button class="createButton" ng-if="selectedPanel === 'publishProducts' && (publishOptions.app.none || publishOptions.catalog.none)" ng-click="handlePublishClick()" ng-disabled="!publishOptions.app.none && !publishOptions.catalog.none" translate>publish</button>
    <button class="createButton" ng-if="selectedPanel === 'bluemix-gatherToken'" ng-disabled="!bluemixTokenSuccess" ng-click="switchSelectedPanel('publishProducts')" translate>next</button>
  </footer>

</div>
