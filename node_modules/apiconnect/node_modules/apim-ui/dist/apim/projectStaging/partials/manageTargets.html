<!--
/********************************************************* {COPYRIGHT-TOP} ***
* Licensed Materials - Property of IBM
* 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
*
* (C) Copyright IBM Corporation 2017
*
* All Rights Reserved.
* US Government Users Restricted Rights - Use, duplication or disclosure
* restricted by GSA ADP Schedule Contract with IBM Corp.
********************************************************** {COPYRIGHT-END} **/
-->
<div class="staging-modal">

  <header class="modal-header" role="banner" aria-label="{{::'stageProject' | translate}}">
    <h2 class="modal-title" ng-if="stagingPanel == 'selectStagingTarget'" translate>publish</h2>
    <h2 class="modal-title" ng-if="stagingPanel == 'selectStagingOrgCatalog'" translate>selectOrgCatalog</h2>
    <h2 class="modal-title" ng-if="stagingPanel == 'bluemix-selectStagingApp'" translate>stageSelectBluemixApp</h2>
    <h2 class="modal-title" ng-if="stagingPanel == 'onprem-selectStagingApp'" translate>stageSelectApp</h2>
    <h2 class="modal-title" ng-if="stagingPanel == 'onprem-addStagingTarget'" translate>signinOnprem</h2>
    <h2 class="modal-title" ng-if="stagingPanel == 'publishOptions'" translate>publish</h2>
    <h2 class="modal-title" ng-if="stagingPanel == 'bluemix-gatherToken'" translate>bluemixLoginTitle</h2>
    <div ng-if="stagingPanel == 'bluemix-registerOrgForApic'">
      <h2 class="modal-title" translate>registerBluemixOrg</h2>
      <div class="title-subheader" translate>registerBluemixOrgFull</div>
    </div>
  </header>

  <section class="modal-body">

    <!-- selectStagingTarget -->
    <div class="theMiddleWay" ng-if="stagingPanel == 'selectStagingTarget'">
      <div class="fullWidth" ng-if="stagingTargets.length > 0" style="margin-bottom: 40px">
        <div class="fullWidth targetButtonRow" ng-repeat="target in stagingTargets">
          <button class="targetButton" ng-click="targetOp.edit(target.info.id)">
            <div class="catalogSpaceLine">
              <span ng-if="!target.info.space.none">{{target.info.space.title}} | </span>
              <span ng-if="!target.info.catalog.none">{{target.info.catalog.name}} | </span>
              <span ng-if="!target.info.app.none">{{target.info.app.entity.name || target.info.app.name}} | </span>
              <span ng-if="target.info.type == 'bluemix'">{{target.info.space.entity.name}} ({{::'bluemix' | translate}})</span>
              <span ng-if="target.info.type== 'onprem'">{{target.info.server.host}}</span>
            </div>
            <div class="orgLine">
              {{target.info.org.displayName}}
            </div>
          </button>
          <button class="deleteButton material-icons" ng-click="targetOp.delete(target.info.id)">
            delete
          </button>
        </div>
      </div>
      <div class="addTargetButtons fullWidth">
        <button class="bx--btn fullWidth" type="button" ng-click="handleClick.addNewTarget('bluemix');">
          <span translate>addTarget-bluemix</span>
        </button>
        <button class="bx--btn fullWidth" type="button" ng-click="handleClick.addNewTarget('onprem')">
          <span translate>addTarget-other</span>
        </button>
      </div>
    </div>

    <!-- Region select -->

    <div class="editorBar" ng-if="stagingPanel == 'selectStagingOrgCatalog' && stagingOptions.type == 'bluemix'">
      <md-input-container ng-if="stagingOptions.type == 'bluemix'">
        <label for="apic_server_input" translate>bluemixRegion</label>
        <md-select id="apic_server_input" ng-model="stagingOptions.server" ng-model-options="{trackBy: '$value.name'}">
          <md-option ng-value="server" ng-repeat="server in apicServers">
            {{server.displayName}}
          </md-option>
        </md-select>
      </md-input-container>
    </div>

    <!-- providerOrganization select -->

    <div class="editorBar" ng-if="stagingPanel == 'selectStagingOrgCatalog' && (!showBluemixTargetSignin || stagingOptions.type != 'bluemix')">
      <md-input-container>
        <label for="staging_org_input" translate>organization</label>
        <md-select id="staging_org_input" ng-model="stagingOptions.org" ng-model-options="{trackBy: '$value.id'}">
          <md-option ng-value="org" ng-repeat="org in providerOrgs">
            {{org.displayName}}
          </md-option>
        </md-select>
      </md-input-container>
      <!--<div class="smallTextLink" ng-if="stagingOptions.type == 'bluemix'">
        <div translate>missingStageOrgText</div>
        <div><a ng-click="handleClick.registerBluemixOrg()" translate>missingStageOrgLink</a></div>
      </div>-->
    </div>

    <!-- selectStagingCatalog -->

    <div class="fullWidth padding0-10" ng-if="stagingPanel == 'selectStagingOrgCatalog' && (!showBluemixTargetSignin || stagingOptions.type != 'bluemix')">
      <div class="listDisabled flex" ng-if="!catalogs || xhrProcessing">
        <div class="spinner" ng-if="xhrProcessing"></div>
      </div>
      <div class="stagingListSelector" class="fullWidth">
        <div class="layout fullWidth searchBanner">
          <div class="displayInline itsAllRelative flex bx--search" role="search">
              <bx-icon class="bx--search__icon--magnifier" icon="search"></bx-icon>
              <label for="search__input" class="bx--search__label">Search</label>
            <input type="search" class="bx--search__input" id="search__input" ng-model="query" placeholder="{{::'search' | translate}}" aria-label="{{::'search' | translate}}" style="border: 0;" class="ng-pristine ng-valid ng-touched" aria-disabled="false" aria-invalid="false">
            <button title="{{::'resetFilter' | translate}}" ng-show="query" ng-click="query = ''" class="iconOnlyButton resetButton ng-hide" type="reset" aria-hidden="true">
              <div class="closeIcon" style="margin-top: -10px"></div>
            </button>
          </div>
        </div>
        <div class="scrollable-list">
          <div class="stagingListSelectorItem"
               ng-if="isLoopbackProject()"
               ng-click="setStagingOption('catalog', {none: true}); setStagingOption('space', {none: true}); hideApprovalWarning()"
               ng-class="{'selected':stagingOptions.catalog.none}">
            <span translate>
              none
            </span>
          </div>
          <div class="stagingListSelectorItem"
            ng-repeat="target in possibleTargets | filter: query"
            ng-click="setStagingOption('catalog', target.catalog); setStagingOption('space', target.space)"
            ng-class="{'selected':stagingOptions.catalog.id == target.catalog.id && stagingOptions.space.id == target.space.id}">
            <span>
              {{target.displayAs}}
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- bluemix target sign in -->

    <div class="fullWidth padding0-10 targetSignIn" ng-if="stagingPanel == 'selectStagingOrgCatalog' && stagingOptions.type == 'bluemix' && showBluemixTargetSignin">
      <div class= "clearLoadingOverlay flex" ng-if="xhrProcessing">
        <div class="spinner" ng-if="xhrProcessing"></div>
      </div>
      <div class="fullWidth" ng-if="bluemixTargetAuthType === 'token'">
        <div class="inputWrapper bluemixLogin" data-ng-click="gatherBluemixToken();" style="margin-top: 20px">
          <button class="bluemix" id="login_button" type="submit" name="login" value="true">{{::'loginBluemix' | translate}}</button>
        </div>
      </div>
      <div class="fullWidth" ng-if="bluemixTargetAuthType === 'basic'">
        <h2 translate style="margin-top: 10px">signinOnprem</h2>
        <md-input-container class="fullWidth">
          <label translate>username</label>
          <input type="text" ng-model="bluemixTargetSignOnInfo.username"/>
        </md-input-container>
        <md-input-container class="fullWidth">
          <label translate>Password</label>
          <input type="password" ng-model="bluemixTargetSignOnInfo.password"/>
        </md-input-container>
      </div>
    </div>

    <!-- bluemix token sign in -->

    <div class="fullWidth padding0-10 targetSignIn" ng-if="stagingPanel == 'bluemix-gatherToken'">
      <div class= "clearLoadingOverlay flex" ng-if="xhrProcessing">
        <div class="spinner" ng-if="xhrProcessing"></div>
      </div>
      <div class="fullWidth">
        <div translate>bluemixLoginText1</div>
        <div translate>bluemixLoginText2</div>
        <div class="inputWrapper bluemixLogin" data-ng-click="gatherBluemixToken();" style="margin-top: 20px">
          <button class="bluemix" id="login_button2" type="submit" name="login" value="true">{{::'loginBluemix' | translate}}</button>
        </div>
      </div>
    </div>


    <!-- selectProductsForStaging -->
    <div class="fullWidth padding0-10" ng-if="stagingPanel == 'selectProductsForStaging'">
      <div class="stagingListSelector" class="fullWidth" style="height: 350px">
        <div class="scrollable-list">
          <div class="stagingListSelectorItem" ng-repeat="product in products" ng-class="{'selected':product.selected}">
            <md-checkbox class="md-primary fullWidth" ng-model="product.selected" aria-label="{{product.info.name}}">
              {{product.info.name}}
            </md-checkbox>
          </div>
        </div>
      </div>
    </div>

    <!-- bluemix-selectStagingApp -->

    <div class="fullWidth padding0-10" ng-if="stagingPanel == 'bluemix-selectStagingApp'">
      <div class="listDisabled flex" ng-if="!bluemixApps || xhrProcessing">
        <div class="spinner" ng-if="xhrProcessing"></div>
      </div>
      <div class="stagingListSelector" class="fullWidth">
        <div class="layout fullWidth searchBanner">
          <div class="displayInline itsAllRelative flex bx--search" role="search">
              <bx-icon class="bx--search__icon--magnifier" icon="search"></bx-icon>
              <label for="search__input" class="bx--search__label">Search</label>
            <input type="search" class="bx--search__input" id="search__input" ng-model="query" placeholder="{{::'search' | translate}}" aria-label="{{::'search' | translate}}" class="ng-pristine ng-valid ng-touched" aria-disabled="false" aria-invalid="false">
            <button title="{{::'resetFilter' | translate}}" ng-show="query" ng-click="query = ''" class="iconOnlyButton resetButton ng-hide" type="reset" aria-hidden="true">
              <div class="closeIcon" style="margin-top: -10px"></div>
            </button>
          </div>
        </div>
        <div class="scrollable-list" style="height:300px">
          <div class="stagingListSelectorItem" ng-if="!stagingOptions.catalog.none" ng-click="setStagingOption('app', {'none': true})" ng-class="{'selected':stagingOptions.app.none == true}">
            <span translate>
              none
            </span>
          </div>
          <div class="stagingListSelectorItem" ng-repeat="app in bluemixApps | filter: query" ng-click="setStagingOption('app', app)" ng-class="{'selected':stagingOptions.app.metadata.guid == app.metadata.guid}">
            <span>
              {{app.entity.name}}
            </span>
          </div>
          <div class="stagingListSelectorItem" ng-if="newBluemixApp" ng-click="setStagingOption('app', newBluemixApp)" ng-class="{'selected':stagingOptions.app.new}">
            <span>
              {{newBluemixApp.name}}
            </span>
          </div>
        </div>
        <div class="whiteBackground layout fullWidth addAppBar">
          <div class="displayInline itsAllRelative flex">
            <input type="text" class="addAppInput displayInline" ng-model="newBluemixAppName" placeholder="{{::'newAppPlaceholder' | translate}}" aria-label="{{::'newAppPlaceholder' | translate}}" class="ng-pristine ng-valid ng-touched" aria-disabled="false" aria-invalid="false"/>
            <button title="{{::'appsAddApp' | translate}}" ng-show="newBluemixAppName" ng-click="addNewBluemixApp(newBluemixAppName);newBluemixAppName = ''" class="iconOnlyButton addAppButton ng-hide" aria-hidden="true">
              <div class="material-icons">add_circle_outline</div>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- onprem-selectStagingApp -->

    <div class="fullWidth padding0-10" ng-if="stagingPanel == 'onprem-selectStagingApp'">
      <div class= "listDisabled flex" ng-if="!providerApps || xhrProcessing">
        <div class="spinner" ng-if="xhrProcessing"></div>
      </div>
      <div class="stagingListSelector" class="fullWidth">
        <div class="layout fullWidth searchBanner">
          <div class="displayInline itsAllRelative flex bx--search" role="search">
              <bx-icon class="bx--search__icon--magnifier" icon="search"></bx-icon>
              <label for="search__input" class="bx--search__label">Search</label>
            <input type="search" class="bx--search__input" id="search__input" ng-model="query" placeholder="{{::'search' | translate}}" aria-label="{{::'search' | translate}}" class="ng-pristine ng-valid ng-touched" aria-disabled="false" aria-invalid="false">
            <button title="{{::'resetFilter' | translate}}" ng-show="query" ng-click="query = ''" class="iconOnlyButton resetButton ng-hide" type="reset" aria-hidden="true">
              <div class="closeIcon" style="margin-top: -10px"></div>
            </button>
          </div>
        </div>
        <div class="scrollable-list">
          <div class="stagingListSelectorItem" ng-if="!stagingOptions.catalog.none" ng-click="setStagingOption('app', {'none': true})" ng-class="{'selected':stagingOptions.app.none == true}">
            <span translate>
              none
            </span>
          </div>
          <div class="stagingListSelectorItem" ng-repeat="app in providerApps | filter: query" ng-click="setStagingOption('app', app)" ng-class="{'selected':stagingOptions.app.id == app.id}">
            <span>
              {{app.name}}
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- onprem-addStagingTarget -->

    <div class="fullWidth padding0-10" ng-if="stagingPanel == 'onprem-addStagingTarget'">
      <div class= "clearLoadingOverlay flex" ng-if="xhrProcessing">
        <div class="spinner" ng-if="xhrProcessing"></div>
      </div>
      <div class="fullWidth">
        <md-input-container class="fullWidth">
          <label translate>hostAddress</label>
          <input type="text" ng-model="onPremSignOnInfo.host"/>
        </md-input-container>
        <md-input-container class="fullWidth">
          <label translate>username</label>
          <input type="text" ng-model="onPremSignOnInfo.username"/>
        </md-input-container>
        <md-input-container class="fullWidth">
          <label translate>Password</label>
          <input type="password" ng-model="onPremSignOnInfo.password"/>
        </md-input-container>
      </div>
    </div>

  </section>


  <footer class="modal-footer" role="contentinfo" aria-label="{{::'footerSectionLabel' | translate}}">
    <div class="bx--sets-of-buttons">
      <button class="bx--btn--secondary bx--btn--sm" type="button" ng-click="close()" translate>cancel</button>
      <button class="bx--btn bx--btn--sm" type="button" ng-if="stagingPanel == 'selectStagingOrgCatalog' && isLoopbackProject() && (!showBluemixTargetSignin || stagingOptions.type != 'bluemix')" ng-disabled="!stagingOptions.catalog" ng-click="handleClick.catalogNext()" translate>next</button>
      <button class="bx--btn bx--btn--sm" type="button" ng-if="stagingPanel == 'bluemix-selectStagingApp' || stagingPanel == 'onprem-selectStagingApp'" ng-disabled="!stagingOptions.app" ng-click="targetOp.save()" translate>save</button>
      <button class="bx--btn bx--btn--sm" type="button" ng-if="stagingPanel == 'selectStagingOrgCatalog' && !isLoopbackProject()" ng-disabled="!stagingOptions.catalog" ng-click="setStagingOption('app', {'none': true}); targetOp.save()" translate>save</button>
      <button class="bx--btn bx--btn--sm" type="button" ng-if="stagingPanel == 'onprem-addStagingTarget'" ng-disabled="!(onPremSignOnInfo.host && onPremSignOnInfo.username && onPremSignOnInfo.password)" ng-click="handleClick.onPremSignOn()" translate>loginSignIn</button>
      <!--<button class="createButton" ng-if="stagingPanel == 'bluemix-registerOrgForApic'" ng-disabled="!selectedOrgRegPlan" ng-click="registerBluemixOrgForApic()" translate>register</button>-->
      <button class="bx--btn bx--btn--sm" type="button" ng-if="stagingPanel == 'selectStagingOrgCatalog' && stagingOptions.type == 'bluemix' && showBluemixTargetSignin" ng-disabled="!(bluemixTargetSignOnInfo.username && bluemixTargetSignOnInfo.password)" ng-click="handleClick.bluemixTargetSignOn()" translate>loginSignIn</button>
      <button class="bx--btn bx--btn--sm" type="button" ng-if="stagingPanel == 'bluemix-gatherToken'" ng-disabled="!bluemixTokenSuccess" ng-click="handleClick.catalogNext()" translate>next</button>
      <button class="bx--btn bx--btn--sm floatLeft" type="button" ng-if="stagingPanel != 'selectStagingTarget'" ng-click="handleClick.back()" translate>back</button>
    </div>
    <!--<div class="fullWidth floatRight smallTextLink" ng-if="stagingPanel == 'bluemix-registerOrgForApic'">
      <span translate>registerBluemixOrgAgree1</span> <a translate>registerBluemixOrgAgree2</a>
    </div>-->
  </footer>

</div>
