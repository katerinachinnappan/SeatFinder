<!--
/********************************************************* {COPYRIGHT-TOP} ***
* Licensed Materials - Property of IBM
* 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
*
* (C) Copyright IBM Corporation 2017
*
* All Rights Reserved.
* US Government Users Restricted Rights - Use, duplication or disclosure
* restricted by GSA ADP Schedule Contract with IBM Corp.
********************************************************** {COPYRIGHT-END} **/
-->
<div class="bx--form__row-item">
  <div style="margin: -5px 0 0 0;">
    <div style="position: relative;" dropdown data-is-open="addFieldDropdownOpen" title="{{::'api_analytics_add' | translate}}">
      <button data-ng-disabled="!swaggerDocument || xhrProcessing" id="{{$id}}_moreActions" title="{{::'api_analytics_add' | translate}}" role="button" class="bx--btn dropdown-toggle" dropdown-toggle>
        {{::'api_analytics_add' | translate}}
        <bx-icon class="bx--btn--right-icon__icon" icon="add--glyph"></bx-icon>
      </button>
      <ul class="dropdown-menu" style="padding: 10px 0; text-align:left;" role="menu" title="{{::'api_analytics_add' | translate}}" onkeypress="addFieldDropdownOpen = true;">
        <li role="menuitem">
          <a aria-label="{{::'api_analytics_add_new' | translate}}" data-ng-click="analyticsCtrl.addField()" href="javascript:;">{{::'api_analytics_add_new' | translate}}</a>
        </li>
        <li class="divider"></li>
        <li role="menuitem" data-ng-repeat="(parameterName, parameter) in swaggerDocument.parameters" data-ng-if="addFieldDropdownOpen && !analyticsCtrl.hasField(parameter) && analyticsCtrl.isBodyOrHeader(parameter)">
          <a aria-label="{{::parameter.name}}" data-ng-click="analyticsCtrl.referenceParameter(parameterName, '#/parameters/' + parameterName, parameter)" href="javascript:;">{{::parameter.name}}</a>
        </li>
      </ul>
    </div>
  </div>
</div>
<div class="editorBar">
  <h5 class="flex">{{::"api_analytics_fields" | translate}}</h5>
</div>
<div class="editorContent">
  <div style="margin: 10px;" data-ng-if="!analyticsContainer.analytics.mappings || analyticsContainer.analytics.mappings.length === 0">{{::'api_analytics_no_field' | translate}}</div>
  <div class='bx--responsive-table-container bxEditorTablePadding' data-ng-if="analyticsContainer.analytics.mappings && analyticsContainer.analytics.mappings.length > 0">
    <table class="bx--responsive-table bxTableBorder">
      <thead class="bx--table-head tableHeaderBackground bxTableHeader">
        <tr class="bx--table-row">
          <th class="bx--table-header bxTablePaddingLeft">{{::'api_analytics_name' | translate}}</th>
          <th class="bx--table-header">{{::'api_analytics_in' | translate}}</th>
          <th class="bx--table-header">{{::'api_analytics_type' | translate}}</th>
          <th class="bx--table-header">{{::'api_analytics_from' | translate}}</th>
          <th class="bx--table-header bxTablePaddingRight"></th>
        </tr>
      </thead>
      <tbody class="bx--table-body">
        <tr class="bx--table-row bx--parent-row" data-ng-repeat="mapping in analyticsContainer.analytics.mappings">
          <td class="bxTablePaddingLeft">
            <bx-input-container data-ng-if="analyticsCtrl.hasMappingName(mapping) || mapping.schema.in">
              <input aria-label="{{::'api_analytics_name' | translate}}" ng-blur="analyticsCtrl.checkEmptyName(mapping)" data-ng-model="mapping.schema.name"/>
            </bx-input-container>
            <bx-input-container data-ng-if="!mapping.schema.in">
              <input aria-label="{{::'api_analytics_name' | translate}}" data-ng-disabled="true" value="{{analyticsCtrl.getReference(mapping.schema.$ref)}}"/>
            </bx-input-container>
          </td>
          <td>
            <div class="bx--select bx--table-select bx--form__row-item">
              <select class="bx--select__input" aria-label="{{::'api_analytics_in' | translate}}" data-ng-if="mapping.schema.in" data-ng-model="mapping.schema.in" style="margin:0;">
                <option value="header">{{::'api_analytics_in_header' | translate}}</option>
                <option value="payload">{{::'api_analytics_in_payload' | translate}}</option>
              </select>
              <bx-icon class="bx--select__arrow" icon="caret--down" data-ng-if="mapping.schema.in"></bx-icon>
              <bx-input-container data-ng-if="!mapping.schema.in">
                <input aria-label="{{::'api_analytics_in' | translate}}" data-ng-disabled="true" value="{{analyticsCtrl.getFieldIn(swaggerDocument.parameters[analyticsCtrl.getReference(mapping.schema.$ref)].in)}}"/>
              </bx-input-container>
            </div>
          </td>
          <td>
            <div class="bx--select bx--table-select bx--form__row-item">
              <select class="bx--select__input" aria-label="{{::'api_analytics_type' | translate}}" data-ng-model="mapping['es-type']" style="margin:0;">
                <!----> 
                <option value="keyword">{{::'api_analytics_type_keyword' | translate}}</option>
                <!---->
                <option value="text">{{::'api_analytics_type_text' | translate}}</option>
                <!---->
                <option value="long">{{::'api_analytics_type_long' | translate}}</option>
                <!---->
                <option value="integer">{{::'api_analytics_type_integer' | translate}}</option>
                <!---->
                <option value="short">{{::'api_analytics_type_short' | translate}}</option>
                <!---->
                <option value="double">{{::'api_analytics_type_double' | translate}}</option>
                <!---->
                <option value="float">{{::'api_analytics_type_float' | translate}}</option>
                <!---->
                <option value="geo_point">{{::'api_analytics_type_geo_point' | translate}}</option>
                <!---->
              </select>
              <bx-icon class="bx--select__arrow" icon="caret--down"></bx-icon>
            </div>
          </td>
          <td>
            <div class="bx--select bx--table-select bx--form__row-item">
              <select class="bx--select__input" aria-label="{{::'api_analytics_from' | translate}}" data-ng-model="mapping.from" style="margin:0;">
                <option value="request">{{::'api_analytics_from_request' | translate}}</option>
                <option value="response">{{::'api_analytics_from_response' | translate}}</option>
              </select>
              <bx-icon class="bx--select__arrow" icon="caret--down"></bx-icon>
            </div>
          </td>
          <td class="alignRight bxTablePaddingRight">
            <apic-component-mover data-ng-if="features.components" class="displayInline alignMiddle" data-reference-source="mapping" data-reference-scope="mappings"></apic-component-mover>
            <button  aria-label="{{::'api_analytics_delete' | translate}}" title="{{::'api_analytics_delete' | translate}}" data-ng-disabled="!swaggerDocument" class="iconOnlyButton bx--form__row-item" data-ng-click="analyticsCtrl.deleteField(mapping)"><div class="material-icons">delete</div></button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
