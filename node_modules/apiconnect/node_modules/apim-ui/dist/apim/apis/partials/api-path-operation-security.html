<!--
/********************************************************* {COPYRIGHT-TOP} ***
* Licensed Materials - Property of IBM
* 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
*
* (C) Copyright IBM Corporation 2017
*
* All Rights Reserved.
* US Government Users Restricted Rights - Use, duplication or disclosure
* restricted by GSA ADP Schedule Contract with IBM Corp.
********************************************************** {COPYRIGHT-END} **/
-->
<div class="bx--form__legend">{{::'api_security' | translate}}</div>
<div data-ng-if="!$ctrl.apiSecurityDefns || $ctrl.isEmpty($ctrl.apiSecurityDefns)">
  <div>{{::'api_no_security_schemas' | translate}}</div>
</div>

<div data-ng-if="$ctrl.apiSecurityDefns && !$ctrl.isEmpty($ctrl.apiSecurityDefns)">
  <div class="bx--form__row-item">
    <md-checkbox md-no-ink aria-label="{{securityDefinitionName}}" data-ng-model="$ctrl.$inheritScheme" data-ng-model-options="{getterSetter:true, debounce:500}" class="md-primary">
      {{::'api_security_scheme_inherit' | translate}}
    </md-checkbox>
  </div>
</div>

<div data-ng-if="$ctrl.apiSecurityDefns && !$ctrl.isEmpty($ctrl.apiSecurityDefns) && $ctrl.operation.security">
  <div class="detailsSection" style="padding: 0; flex: 1;">
    <div class="floatRight" style="margin: -35px 10px 0 0;">
      <button class="iconOnlyButton"
        aria-label="{{::'api_security_add_security_option' | translate}}"
        data-ng-disabled="!$ctrl.operation"
        data-ng-click="$ctrl.addSecurityOption()">
          <div class="material-icons">add_circle_outline</div>
      </button>
    </div>

    <div data-ng-repeat="securityOption in $ctrl.operation.security" class="detailsSplitSection" style="display: flex; padding: 20px; padding-bottom: 5px;">
      <div class="displayInline alignTop" style="margin-right: 20px; margin-top: 1px;">
        {{::'api_security_option' | translate}}{{$index+1}}
      </div>
      <div class="displayInline alignTop" style="flex: 1;">
        <div data-ng-repeat="(securityDefinitionName, securityDefinition) in $ctrl.apiSecurityDefns"
          data-ng-controller="schemeController as $schemeCtrl">
          <div class="displayInline alignTop inlineCheckbox" style="min-width: 25%">
            <bx-checkbox aria-label="{{securityDefinitionName}}" data-ng-model="$schemeCtrl.$schemeEnabled" data-ng-model-options="{getterSetter:true, debounce:500}">
              {{securityDefinitionName}} ({{::'api_security_type_' + securityDefinition.type | translate}})
            </bx-checkbox>
          </div>

          <div class="displayInline alignTop" style="margin-left: 20px;" data-ng-if="$schemeCtrl.$schemeEnabled() && securityDefinition.scopes"
            data-ng-repeat="(scope, scopeObject) in securityDefinition.scopes" data-ng-controller="ApiSecuritySchemeScopeController">
            <bx-checkbox aria-label="{{::scope}}" data-ng-model="$scopeEnabled" data-ng-model-options="{getterSetter:true}">
              {{::scope}}
            </bx-checkbox>
          </div>
        </div>
      </div>

      <div class="displayInline alignTop">
        <button style="margin: -3px 0px 0px 0px;" class="iconOnlyButton material-icons"
          data-ng-click="$ctrl.moveUpSecurityOption($index)"
          data-ng-if="$index > 0"
          title="{{::'assemblyMoveUp' | translate}}">arrow_upward
        </button>
        <button style="margin: -3px 0px 0px 0px;" class="iconOnlyButton material-icons"
          data-ng-if="$index < $ctrl.operation.security.length - 1"
          data-ng-click="$ctrl.moveDownSecurityOption($index)"
          title="{{::'assemblyMoveDown' | translate}}">arrow_downward
        </button>
        <button style="margin-top: -3px;" class="material-icons iconOnlyButton"
          title="{{::'api_security_delete_option' | translate}}"
          aria-label="{{::'api_security_delete_option' | translate}}"
          data-ng-disabled="!$ctrl.operation"
          data-ng-click="$ctrl.deleteSecurityOption($index)">delete
        </button>
      </div>
    </div>
  </div>
</div>
